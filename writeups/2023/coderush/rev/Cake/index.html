<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This site is a digital home to my thoughts and experiences. I also share my ctf writeups here time to time."><meta name=author content="Md Abdullahil Kafi"><link rel=canonical href=https://gr007-40.github.io/writeups/2023/coderush/rev/Cake/index.html><link rel=prev href=../../../bcactf/rev/git_better/index.html><link rel=next href=../keasy/index.html><link rel=icon href=../../../../../assets/favicon.png><meta name=generator content="mkdocs-1.5.2, mkdocs-material-9.1.21"><title>Chocolate Cake - gr007</title><link rel=stylesheet href=../../../../../assets/stylesheets/main.eebd395e.min.css><link rel=stylesheet href=../../../../../assets/stylesheets/palette.ecc896b0.min.css><style>.md-tag--pwn{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 12h-4v-2h4m0 6h-4v-2h4m6-6h-2.81a5.985 5.985 0 0 0-1.82-1.96L17 4.41 15.59 3l-2.17 2.17a6.002 6.002 0 0 0-2.83 0L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8Z"/></svg>');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Code:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Fira Code";--md-code-font:"Fira Mono"}</style><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css><script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Chocolate Cake - gr007"><meta property=og:description content="This site is a digital home to my thoughts and experiences. I also share my ctf writeups here time to time."><meta property=og:image content=https://gr007-40.github.io/assets/images/social/writeups/2023/coderush/rev/Cake/index.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta property=og:url content=https://gr007-40.github.io/writeups/2023/coderush/rev/Cake/index.html><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Chocolate Cake - gr007"><meta name=twitter:description content="This site is a digital home to my thoughts and experiences. I also share my ctf writeups here time to time."><meta name=twitter:image content=https://gr007-40.github.io/assets/images/social/writeups/2023/coderush/rev/Cake/index.png> <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=blue> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#chocolate-cake class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../.. title=gr007 class="md-header__button md-logo" aria-label=gr007 data-md-component=logo> <img src=../../../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> gr007 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Chocolate Cake </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=blue aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/gr007-40/gr007-40.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> gr007-40.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../bcactf/rev/git_better/index.html class="md-tabs__link md-tabs__link--active"> Writeups </a> </li> <li class=md-tabs__item> <a href=../../../../../blog/posts/hello-world.html class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../../../tags.html class=md-tabs__link> Tags </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../.. title=gr007 class="md-nav__button md-logo" aria-label=gr007 data-md-component=logo> <img src=../../../../../assets/logo.png alt=logo> </a> gr007 </label> <div class=md-nav__source> <a href=https://github.com/gr007-40/gr007-40.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> gr007-40.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> Writeups <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Writeups </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_1 checked> <label class=md-nav__link for=__nav_1_1 id=__nav_1_1_label tabindex=0> 2023 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1_1> <span class="md-nav__icon md-icon"></span> 2023 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_1_1> <label class=md-nav__link for=__nav_1_1_1 id=__nav_1_1_1_label tabindex=0> bcactf <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_1_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1_1_1> <span class="md-nav__icon md-icon"></span> bcactf </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_1_1_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../bcactf/rev/git_better/index.html>rev</a> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_1_1_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1_1_1_1> <span class="md-nav__icon md-icon"></span> rev </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_1_2 checked> <label class=md-nav__link for=__nav_1_1_2 id=__nav_1_1_2_label tabindex=0> coderush <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_1_1_2_label aria-expanded=true> <label class=md-nav__title for=__nav_1_1_2> <span class="md-nav__icon md-icon"></span> coderush </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_1_2_1 checked> <div class="md-nav__link md-nav__link--index md-nav__link--active"> <a href=index.html>rev</a> <label for=__nav_1_1_2_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_1_1_2_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1_1_2_1> <span class="md-nav__icon md-icon"></span> rev </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../keasy/index.html class=md-nav__link> Keasy </a> </li> <li class=md-nav__item> <a href=../matrix/index.html class=md-nav__link> Matrix </a> </li> <li class=md-nav__item> <a href=../Nest/index.html class=md-nav__link> Nest </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_1_2_2> <div class="md-nav__link md-nav__link--index "> <a href=../../pwn/format_string/index.html>pwn</a> <label for=__nav_1_1_2_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_1_1_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_1_2_2> <span class="md-nav__icon md-icon"></span> pwn </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pwn/seed/index.html class=md-nav__link> Seed </a> </li> <li class=md-nav__item> <a href=../../pwn/three_sum/index.html class=md-nav__link> Three Sum </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex=0> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2_1> <label class=md-nav__link for=__nav_1_2_1 id=__nav_1_2_1_label tabindex=0> flaghunt <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_1_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2_1> <span class="md-nav__icon md-icon"></span> flaghunt </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2_1_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../../2022/flaghunt/rev/weird_code/index.html>rev</a> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_1_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2_1_1> <span class="md-nav__icon md-icon"></span> rev </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Blog <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../blog/posts/hello-world.html class=md-nav__link> Hello World </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> Tags <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tags </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../tags.html class=md-nav__link> Tags </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#description class=md-nav__link> Description </a> </li> <li class=md-nav__item> <a href=#solution class=md-nav__link> Solution </a> <nav class=md-nav aria-label=Solution> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ghidra-black-magic class=md-nav__link> Ghidra black magic </a> </li> <li class=md-nav__item> <a href=#function-breakdown class=md-nav__link> Function breakdown </a> <nav class=md-nav aria-label="Function breakdown"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#main class=md-nav__link> main </a> </li> <li class=md-nav__item> <a href=#bake_a_cake class=md-nav__link> bake_a_cake </a> </li> <li class=md-nav__item> <a href=#prepare class=md-nav__link> prepare </a> </li> <li class=md-nav__item> <a href=#whisk_and_mix class=md-nav__link> whisk_and_mix </a> </li> <li class=md-nav__item> <a href=#bake_and_frost class=md-nav__link> bake_and_frost </a> </li> <li class=md-nav__item> <a href=#serve_the_cake-and-taste_cake class=md-nav__link> serve_the_cake and taste_cake </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a href=../../../../../tags.html#rev class="md-tag md-tag-icon">rev</a> <a href=../../../../../tags.html#2023 class="md-tag md-tag-icon">2023</a> <a href=../../../../../tags.html#flaghunt class="md-tag md-tag-icon">flaghunt</a> </nav> <a href=https://github.com/gr007-40/gr007-40.github.io/raw/master/docs/writeups/2023/coderush/rev/Cake/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=chocolate-cake>Chocolate Cake<a class=headerlink href=#chocolate-cake title="Permanent link">&para;</a></h1> <h2 id=description>Description<a class=headerlink href=#description title="Permanent link">&para;</a></h2> <p>I found the best <a href=recipe>recipe</a> for Cake in the world. But this recipe needs a secret ingredient which I don't know. Help me discover the hidden secrets of this recipe and I will make the best cake for you.</p> <p>You can access the kitchen with <code>nc 139.59.0.163 1740</code></p> <p><strong>flag format:</strong> <code>coderush{fl4g}</code></p> <blockquote> <p>Author: <code>gr007</code></p> </blockquote> <h2 id=solution>Solution<a class=headerlink href=#solution title="Permanent link">&para;</a></h2> <p>The recipe wants a secret ingredient when executed. Let's see what we can see in Ghidra. I have done some light renaming and so on. now let's try to recreate the recipe. It's pretty amazing how much similar the decompiled source is compared to the actual source code.</p> <h3 id=ghidra-black-magic>Ghidra black magic<a class=headerlink href=#ghidra-black-magic title="Permanent link">&para;</a></h3> <details class=recipe_from_ghidra> <summary>Recipe_from_ghidra</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="  1 "></span></a><span class=n>byte</span><span class=w> </span><span class=nf>taste_cake</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>cake</span><span class=p>)</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2></a><a href=#__codelineno-0-2><span class=linenos data-linenos="  2 "></span></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3></a><a href=#__codelineno-0-3><span class=linenos data-linenos="  3 "></span></a><span class=p>{</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4></a><a href=#__codelineno-0-4><span class=linenos data-linenos="  4 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5></a><a href=#__codelineno-0-5><span class=linenos data-linenos="  5 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>some_cake</span><span class=w> </span><span class=p>[</span><span class=mi>23</span><span class=p>];</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6></a><a href=#__codelineno-0-6><span class=linenos data-linenos="  6 "></span></a><span class=w>    </span><span class=n>byte</span><span class=w> </span><span class=n>f</span><span class=p>;</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7></a><a href=#__codelineno-0-7><span class=linenos data-linenos="  7 "></span></a>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8></a><a href=#__codelineno-0-8><span class=linenos data-linenos="  8 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>.</span><span class=n>_0_8_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x1070426e70144e3c</span><span class=p>;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9></a><a href=#__codelineno-0-9><span class=linenos data-linenos="  9 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>.</span><span class=n>_8_7_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x5413116e370e29</span><span class=p>;</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10></a><a href=#__codelineno-0-10><span class=linenos data-linenos=" 10 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x74</span><span class=p>;</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11></a><a href=#__codelineno-0-11><span class=linenos data-linenos=" 11 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>.</span><span class=n>_16_7_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x6a356833540227</span><span class=p>;</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12></a><a href=#__codelineno-0-12><span class=linenos data-linenos=" 12 "></span></a><span class=w>    </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13></a><a href=#__codelineno-0-13><span class=linenos data-linenos=" 13 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14></a><a href=#__codelineno-0-14><span class=linenos data-linenos=" 14 "></span></a><span class=w>        </span><span class=n>f</span><span class=w> </span><span class=o>&amp;=</span><span class=w> </span><span class=n>cake</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>some_cake</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15></a><a href=#__codelineno-0-15><span class=linenos data-linenos=" 15 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16></a><a href=#__codelineno-0-16><span class=linenos data-linenos=" 16 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17></a><a href=#__codelineno-0-17><span class=linenos data-linenos=" 17 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18></a><a href=#__codelineno-0-18><span class=linenos data-linenos=" 18 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19></a><a href=#__codelineno-0-19><span class=linenos data-linenos=" 19 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20></a><a href=#__codelineno-0-20><span class=linenos data-linenos=" 20 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>f</span><span class=p>;</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21></a><a href=#__codelineno-0-21><span class=linenos data-linenos=" 21 "></span></a><span class=p>}</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22></a><a href=#__codelineno-0-22><span class=linenos data-linenos=" 22 "></span></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23></a><a href=#__codelineno-0-23><span class=linenos data-linenos=" 23 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>serve_the_cake</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>cake</span><span class=p>)</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24></a><a href=#__codelineno-0-24><span class=linenos data-linenos=" 24 "></span></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25></a><a href=#__codelineno-0-25><span class=linenos data-linenos=" 25 "></span></a><span class=p>{</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26></a><a href=#__codelineno-0-26><span class=linenos data-linenos=" 26 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>tasty</span><span class=p>;</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27></a><a href=#__codelineno-0-27><span class=linenos data-linenos=" 27 "></span></a><span class=w>    </span><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>file</span><span class=p>;</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28></a><a href=#__codelineno-0-28><span class=linenos data-linenos=" 28 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29></a><a href=#__codelineno-0-29><span class=linenos data-linenos=" 29 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>flag</span><span class=w> </span><span class=p>[</span><span class=mi>72</span><span class=p>];</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30></a><a href=#__codelineno-0-30><span class=linenos data-linenos=" 30 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31></a><a href=#__codelineno-0-31><span class=linenos data-linenos=" 31 "></span></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32></a><a href=#__codelineno-0-32><span class=linenos data-linenos=" 32 "></span></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>);</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33></a><a href=#__codelineno-0-33><span class=linenos data-linenos=" 33 "></span></a><span class=w>    </span><span class=n>tasty</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>taste_cake</span><span class=p>(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34></a><a href=#__codelineno-0-34><span class=linenos data-linenos=" 34 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tasty</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35></a><a href=#__codelineno-0-35><span class=linenos data-linenos=" 35 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;You cannot just make a secret ingredient up. (-_-)&quot;</span><span class=p>);</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36></a><a href=#__codelineno-0-36><span class=linenos data-linenos=" 36 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37></a><a href=#__codelineno-0-37><span class=linenos data-linenos=" 37 "></span></a><span class=w>        </span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38></a><a href=#__codelineno-0-38><span class=linenos data-linenos=" 38 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39></a><a href=#__codelineno-0-39><span class=linenos data-linenos=" 39 "></span></a><span class=w>    </span><span class=n>file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=s>&quot;flag.txt&quot;</span><span class=p>,</span><span class=s>&quot;r&quot;</span><span class=p>);</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40></a><a href=#__codelineno-0-40><span class=linenos data-linenos=" 40 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>file</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41></a><a href=#__codelineno-0-41><span class=linenos data-linenos=" 41 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;file not found</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42></a><a href=#__codelineno-0-42><span class=linenos data-linenos=" 42 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;If you are on a remote server contact the admin asap.&quot;</span><span class=p>);</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43></a><a href=#__codelineno-0-43><span class=linenos data-linenos=" 43 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;If you are on your local machine, create a flag.txt so that you can debug easily.&quot;</span><span class=p>);</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44></a><a href=#__codelineno-0-44><span class=linenos data-linenos=" 44 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45></a><a href=#__codelineno-0-45><span class=linenos data-linenos=" 45 "></span></a><span class=w>        </span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46></a><a href=#__codelineno-0-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47></a><a href=#__codelineno-0-47><span class=linenos data-linenos=" 47 "></span></a><span class=w>    </span><span class=n>fgets</span><span class=p>(</span><span class=n>flag</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=n>file</span><span class=p>);</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48></a><a href=#__codelineno-0-48><span class=linenos data-linenos=" 48 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=n>flag</span><span class=p>);</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49></a><a href=#__codelineno-0-49><span class=linenos data-linenos=" 49 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50></a><a href=#__codelineno-0-50><span class=linenos data-linenos=" 50 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51></a><a href=#__codelineno-0-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52></a><a href=#__codelineno-0-52><span class=linenos data-linenos=" 52 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53></a><a href=#__codelineno-0-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54></a><a href=#__codelineno-0-54><span class=linenos data-linenos=" 54 "></span></a><span class=p>}</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55></a><a href=#__codelineno-0-55><span class=linenos data-linenos=" 55 "></span></a>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56></a><a href=#__codelineno-0-56><span class=linenos data-linenos=" 56 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>bake_and_frost</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>secret_ingredient</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57></a><a href=#__codelineno-0-57><span class=linenos data-linenos=" 57 "></span></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58></a><a href=#__codelineno-0-58><span class=linenos data-linenos=" 58 "></span></a><span class=p>{</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59></a><a href=#__codelineno-0-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60></a><a href=#__codelineno-0-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61></a><a href=#__codelineno-0-61><span class=linenos data-linenos=" 61 "></span></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62></a><a href=#__codelineno-0-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;bakin...&quot;</span><span class=p>);</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63></a><a href=#__codelineno-0-63><span class=linenos data-linenos=" 63 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done...&quot;</span><span class=p>);</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64></a><a href=#__codelineno-0-64><span class=linenos data-linenos=" 64 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=p>(</span><span class=n>secret_len</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mi>31</span><span class=p>);</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65></a><a href=#__codelineno-0-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66></a><a href=#__codelineno-0-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67></a><a href=#__codelineno-0-67><span class=linenos data-linenos=" 67 "></span></a><span class=w>                </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68></a><a href=#__codelineno-0-68><span class=linenos data-linenos=" 68 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69></a><a href=#__codelineno-0-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70></a><a href=#__codelineno-0-70><span class=linenos data-linenos=" 70 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;frostin...&quot;</span><span class=p>);</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71></a><a href=#__codelineno-0-71><span class=linenos data-linenos=" 71 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done...&quot;</span><span class=p>);</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72></a><a href=#__codelineno-0-72><span class=linenos data-linenos=" 72 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73></a><a href=#__codelineno-0-73><span class=linenos data-linenos=" 73 "></span></a><span class=p>}</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74></a><a href=#__codelineno-0-74><span class=linenos data-linenos=" 74 "></span></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75></a><a href=#__codelineno-0-75><span class=linenos data-linenos=" 75 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>whisk_and_mix</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>secret_ingredient</span><span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76></a><a href=#__codelineno-0-76><span class=linenos data-linenos=" 76 "></span></a>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77></a><a href=#__codelineno-0-77><span class=linenos data-linenos=" 77 "></span></a><span class=p>{</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78></a><a href=#__codelineno-0-78><span class=linenos data-linenos=" 78 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79></a><a href=#__codelineno-0-79><span class=linenos data-linenos=" 79 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80></a><a href=#__codelineno-0-80><span class=linenos data-linenos=" 80 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>;</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81></a><a href=#__codelineno-0-81><span class=linenos data-linenos=" 81 "></span></a>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82></a><a href=#__codelineno-0-82><span class=linenos data-linenos=" 82 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;whiskin...&quot;</span><span class=p>);</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83></a><a href=#__codelineno-0-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done&quot;</span><span class=p>);</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84></a><a href=#__codelineno-0-84><span class=linenos data-linenos=" 84 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85></a><a href=#__codelineno-0-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><a href=#__codelineno-0-86><span class=linenos data-linenos=" 86 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><a href=#__codelineno-0-87><span class=linenos data-linenos=" 87 "></span></a><span class=w>                </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><a href=#__codelineno-0-88><span class=linenos data-linenos=" 88 "></span></a><span class=w>            </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><a href=#__codelineno-0-89><span class=linenos data-linenos=" 89 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><a href=#__codelineno-0-90><span class=linenos data-linenos=" 90 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><a href=#__codelineno-0-91><span class=linenos data-linenos=" 91 "></span></a><span class=w>                </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a><a href=#__codelineno-0-92><span class=linenos data-linenos=" 92 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a><a href=#__codelineno-0-93><span class=linenos data-linenos=" 93 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a><a href=#__codelineno-0-94><span class=linenos data-linenos=" 94 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;mixin...&quot;</span><span class=p>);</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a><a href=#__codelineno-0-95><span class=linenos data-linenos=" 95 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done&quot;</span><span class=p>);</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a><a href=#__codelineno-0-96><span class=linenos data-linenos=" 96 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a><a href=#__codelineno-0-97><span class=linenos data-linenos=" 97 "></span></a><span class=p>}</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a><a href=#__codelineno-0-98><span class=linenos data-linenos=" 98 "></span></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a><a href=#__codelineno-0-99><span class=linenos data-linenos=" 99 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>prepare</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>secret_ingredient</span><span class=p>)</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a><a href=#__codelineno-0-100><span class=linenos data-linenos="100 "></span></a>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101></a><a href=#__codelineno-0-101><span class=linenos data-linenos="101 "></span></a><span class=p>{</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102></a><a href=#__codelineno-0-102><span class=linenos data-linenos="102 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><a href=#__codelineno-0-103><span class=linenos data-linenos="103 "></span></a>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><a href=#__codelineno-0-104><span class=linenos data-linenos="104 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;prepin...&quot;</span><span class=p>);</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><a href=#__codelineno-0-105><span class=linenos data-linenos="105 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><a href=#__codelineno-0-106><span class=linenos data-linenos="106 "></span></a><span class=w>        </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><a href=#__codelineno-0-107><span class=linenos data-linenos="107 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-84</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>((</span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-84</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>26</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>-26</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=sc>&#39;a&#39;</span><span class=p>;</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><a href=#__codelineno-0-108><span class=linenos data-linenos="108 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><a href=#__codelineno-0-109><span class=linenos data-linenos="109 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done&quot;</span><span class=p>);</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a><a href=#__codelineno-0-110><span class=linenos data-linenos="110 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a><a href=#__codelineno-0-111><span class=linenos data-linenos="111 "></span></a><span class=p>}</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a><a href=#__codelineno-0-112><span class=linenos data-linenos="112 "></span></a>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a><a href=#__codelineno-0-113><span class=linenos data-linenos="113 "></span></a>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a><a href=#__codelineno-0-114><span class=linenos data-linenos="114 "></span></a><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nf>bake_a_cake</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>secret_ingredient</span><span class=p>)</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115></a><a href=#__codelineno-0-115><span class=linenos data-linenos="115 "></span></a>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116></a><a href=#__codelineno-0-116><span class=linenos data-linenos="116 "></span></a><span class=p>{</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><a href=#__codelineno-0-117><span class=linenos data-linenos="117 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a><a href=#__codelineno-0-118><span class=linenos data-linenos="118 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><a href=#__codelineno-0-119><span class=linenos data-linenos="119 "></span></a><span class=w>    </span><span class=n>code</span><span class=w> </span><span class=o>*</span><span class=n>recipe</span><span class=w> </span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><a href=#__codelineno-0-120><span class=linenos data-linenos="120 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><a href=#__codelineno-0-121><span class=linenos data-linenos="121 "></span></a>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><a href=#__codelineno-0-122><span class=linenos data-linenos="122 "></span></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>);</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><a href=#__codelineno-0-123><span class=linenos data-linenos="123 "></span></a><span class=w>    </span><span class=n>recipe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>prepare</span><span class=p>;</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><a href=#__codelineno-0-124><span class=linenos data-linenos="124 "></span></a><span class=w>    </span><span class=n>recipe</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>whisk_and_mix</span><span class=p>;</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><a href=#__codelineno-0-125><span class=linenos data-linenos="125 "></span></a><span class=w>    </span><span class=n>recipe</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bake_and_frost</span><span class=p>;</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><a href=#__codelineno-0-126><span class=linenos data-linenos="126 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><a href=#__codelineno-0-127><span class=linenos data-linenos="127 "></span></a><span class=w>        </span><span class=p>(</span><span class=o>*</span><span class=n>recipe</span><span class=p>[</span><span class=n>i</span><span class=p>])(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a><a href=#__codelineno-0-128><span class=linenos data-linenos="128 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a><a href=#__codelineno-0-129><span class=linenos data-linenos="129 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a><a href=#__codelineno-0-130><span class=linenos data-linenos="130 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a><a href=#__codelineno-0-131><span class=linenos data-linenos="131 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a><a href=#__codelineno-0-132><span class=linenos data-linenos="132 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a><a href=#__codelineno-0-133><span class=linenos data-linenos="133 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>;</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a><a href=#__codelineno-0-134><span class=linenos data-linenos="134 "></span></a><span class=p>}</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a><a href=#__codelineno-0-135><span class=linenos data-linenos="135 "></span></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a><a href=#__codelineno-0-136><span class=linenos data-linenos="136 "></span></a>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a><a href=#__codelineno-0-137><span class=linenos data-linenos="137 "></span></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a><a href=#__codelineno-0-138><span class=linenos data-linenos="138 "></span></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a><a href=#__codelineno-0-139><span class=linenos data-linenos="139 "></span></a><span class=p>{</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140></a><a href=#__codelineno-0-140><span class=linenos data-linenos="140 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141></a><a href=#__codelineno-0-141><span class=linenos data-linenos="141 "></span></a><span class=w>    </span><span class=kt>size_t</span><span class=w> </span><span class=n>sVar1</span><span class=p>;</span>
</span><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><a href=#__codelineno-0-142><span class=linenos data-linenos="142 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>cake</span><span class=p>;</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a><a href=#__codelineno-0-143><span class=linenos data-linenos="143 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a><a href=#__codelineno-0-144><span class=linenos data-linenos="144 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a><a href=#__codelineno-0-145><span class=linenos data-linenos="145 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>secret_ingredient</span><span class=w> </span><span class=p>[</span><span class=mi>40</span><span class=p>];</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a><a href=#__codelineno-0-146><span class=linenos data-linenos="146 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a><a href=#__codelineno-0-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><a href=#__codelineno-0-148><span class=linenos data-linenos="148 "></span></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>);</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><a href=#__codelineno-0-149><span class=linenos data-linenos="149 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;The best cake has the best of secret ingredients&quot;</span><span class=p>);</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><a href=#__codelineno-0-150><span class=linenos data-linenos="150 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;What is your best secret ingredient?&quot;</span><span class=p>);</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><a href=#__codelineno-0-151><span class=linenos data-linenos="151 "></span></a><span class=w>    </span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>secret_ingredient</span><span class=p>,</span><span class=mi>32</span><span class=p>);</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a><a href=#__codelineno-0-152><span class=linenos data-linenos="152 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>32</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><a href=#__codelineno-0-153><span class=linenos data-linenos="153 "></span></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=sc>&#39;\n&#39;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><a href=#__codelineno-0-154><span class=linenos data-linenos="154 "></span></a><span class=w>            </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><a href=#__codelineno-0-155><span class=linenos data-linenos="155 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><a href=#__codelineno-0-156><span class=linenos data-linenos="156 "></span></a><span class=w>        </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><a href=#__codelineno-0-157><span class=linenos data-linenos="157 "></span></a><span class=w>            </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><a href=#__codelineno-0-158><span class=linenos data-linenos="158 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><a href=#__codelineno-0-159><span class=linenos data-linenos="159 "></span></a><span class=w>        </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><a href=#__codelineno-0-160><span class=linenos data-linenos="160 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><a href=#__codelineno-0-161><span class=linenos data-linenos="161 "></span></a><span class=w>    </span><span class=n>sVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strlen</span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><a href=#__codelineno-0-162><span class=linenos data-linenos="162 "></span></a><span class=w>    </span><span class=n>secret_len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sVar1</span><span class=p>;</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><a href=#__codelineno-0-163><span class=linenos data-linenos="163 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>secret_len</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><a href=#__codelineno-0-164><span class=linenos data-linenos="164 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;You are not someone who is supposed to know the super secret ingredient.&quot;</span><span class=p>);</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><a href=#__codelineno-0-165><span class=linenos data-linenos="165 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a><a href=#__codelineno-0-166><span class=linenos data-linenos="166 "></span></a><span class=w>        </span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a><a href=#__codelineno-0-167><span class=linenos data-linenos="167 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a><a href=#__codelineno-0-168><span class=linenos data-linenos="168 "></span></a><span class=w>    </span><span class=n>cake</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bake_a_cake</span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a><a href=#__codelineno-0-169><span class=linenos data-linenos="169 "></span></a><span class=w>    </span><span class=n>serve_the_cake</span><span class=p>(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a><a href=#__codelineno-0-170><span class=linenos data-linenos="170 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a><a href=#__codelineno-0-171><span class=linenos data-linenos="171 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a><a href=#__codelineno-0-172><span class=linenos data-linenos="172 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a><a href=#__codelineno-0-173><span class=linenos data-linenos="173 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a><a href=#__codelineno-0-174><span class=linenos data-linenos="174 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a><a href=#__codelineno-0-175><span class=linenos data-linenos="175 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <h3 id=function-breakdown>Function breakdown<a class=headerlink href=#function-breakdown title="Permanent link">&para;</a></h3> <h4 id=main>main<a class=headerlink href=#main title="Permanent link">&para;</a></h4> <details class=main> <summary>Main</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><a href=#__codelineno-1-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(){</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a><a href=#__codelineno-1-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><a href=#__codelineno-1-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=kt>size_t</span><span class=w> </span><span class=n>sVar1</span><span class=p>;</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><a href=#__codelineno-1-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>cake</span><span class=p>;</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><a href=#__codelineno-1-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a><a href=#__codelineno-1-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7></a><a href=#__codelineno-1-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>secret_ingredient</span><span class=w> </span><span class=p>[</span><span class=mi>40</span><span class=p>];</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8></a><a href=#__codelineno-1-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9></a><a href=#__codelineno-1-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10></a><a href=#__codelineno-1-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>);</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11></a><a href=#__codelineno-1-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;The best cake has the best of secret ingredients&quot;</span><span class=p>);</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12></a><a href=#__codelineno-1-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;What is your best secret ingredient?&quot;</span><span class=p>);</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13></a><a href=#__codelineno-1-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=n>read</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>secret_ingredient</span><span class=p>,</span><span class=mi>32</span><span class=p>);</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14></a><a href=#__codelineno-1-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>32</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15></a><a href=#__codelineno-1-15><span class=linenos data-linenos="15 "></span></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=sc>&#39;\n&#39;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16></a><a href=#__codelineno-1-16><span class=linenos data-linenos="16 "></span></a><span class=w>            </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17></a><a href=#__codelineno-1-17><span class=linenos data-linenos="17 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18></a><a href=#__codelineno-1-18><span class=linenos data-linenos="18 "></span></a><span class=w>        </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19></a><a href=#__codelineno-1-19><span class=linenos data-linenos="19 "></span></a><span class=w>            </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20></a><a href=#__codelineno-1-20><span class=linenos data-linenos="20 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21></a><a href=#__codelineno-1-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22></a><a href=#__codelineno-1-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23></a><a href=#__codelineno-1-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=n>sVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strlen</span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24></a><a href=#__codelineno-1-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=n>secret_len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sVar1</span><span class=p>;</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25></a><a href=#__codelineno-1-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>secret_len</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>23</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26></a><a href=#__codelineno-1-26><span class=linenos data-linenos="26 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;You are not someone who is supposed to know the super secret ingredient.&quot;</span><span class=p>);</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27></a><a href=#__codelineno-1-27><span class=linenos data-linenos="27 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28></a><a href=#__codelineno-1-28><span class=linenos data-linenos="28 "></span></a><span class=w>        </span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29></a><a href=#__codelineno-1-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30></a><a href=#__codelineno-1-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=n>cake</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bake_a_cake</span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31></a><a href=#__codelineno-1-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=n>serve_the_cake</span><span class=p>(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32></a><a href=#__codelineno-1-32><span class=linenos data-linenos="32 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33></a><a href=#__codelineno-1-33><span class=linenos data-linenos="33 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34></a><a href=#__codelineno-1-34><span class=linenos data-linenos="34 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35></a><a href=#__codelineno-1-35><span class=linenos data-linenos="35 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36></a><a href=#__codelineno-1-36><span class=linenos data-linenos="36 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37></a><a href=#__codelineno-1-37><span class=linenos data-linenos="37 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>The main function takes the <code>secret_ingredient</code> using read function. Then checks for length. So, we know that the length of the secret_ingredient is 23. then there is a call to <code>bake_a_cake(secret_ingredient)</code>. the function returns a <code>cake</code> and the <code>cake</code> is then served by <code>serve_the_cake(cake)</code> function. We now write a function that will do the opposite of what the main function does in another main function. <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><a href=#__codelineno-2-1><span class=linenos data-linenos="1 "></span></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(){</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2></a><a href=#__codelineno-2-2><span class=linenos data-linenos="2 "></span></a><span class=w>    </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>get_a_cake</span><span class=p>();</span><span class=w>  </span><span class=c1>//get the cake from serve_the_cake(cake) function</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3></a><a href=#__codelineno-2-3><span class=linenos data-linenos="3 "></span></a><span class=w>    </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>secret_ingredient</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cake_a_bake</span><span class=p>(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4></a><a href=#__codelineno-2-4><span class=linenos data-linenos="4 "></span></a><span class=w>    </span><span class=n>preserve</span><span class=p>(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5></a><a href=#__codelineno-2-5><span class=linenos data-linenos="5 "></span></a><span class=p>}</span>
</span></code></pre></div> As we saw in <code>serve_the_cake</code> function, the function compares the output of <code>bake_a_cake</code> with a premade cake inside <code>taste_cake</code> and returns 1 or 0. so, we can later just take the cake from taste_cake function and find out the secret_ingredient from the cake.</p> <h4 id=bake_a_cake>bake_a_cake<a class=headerlink href=#bake_a_cake title="Permanent link">&para;</a></h4> <details class=bake_a_cake> <summary>Bake_a_cake</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><a href=#__codelineno-3-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=nf>bake_a_cake</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>){</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><a href=#__codelineno-3-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><a href=#__codelineno-3-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><a href=#__codelineno-3-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=n>code</span><span class=w> </span><span class=o>*</span><span class=n>recipe</span><span class=w> </span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><a href=#__codelineno-3-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><a href=#__codelineno-3-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a><a href=#__codelineno-3-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>);</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><a href=#__codelineno-3-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=n>recipe</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>prepare</span><span class=p>;</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><a href=#__codelineno-3-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=n>recipe</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>whisk_and_mix</span><span class=p>;</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><a href=#__codelineno-3-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=n>recipe</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bake_and_frost</span><span class=p>;</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a><a href=#__codelineno-3-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><a href=#__codelineno-3-12><span class=linenos data-linenos="12 "></span></a><span class=w>        </span><span class=p>(</span><span class=o>*</span><span class=n>recipe</span><span class=p>[</span><span class=n>i</span><span class=p>])(</span><span class=n>secret_ingredient</span><span class=p>);</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><a href=#__codelineno-3-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a><a href=#__codelineno-3-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a><a href=#__codelineno-3-15><span class=linenos data-linenos="15 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><a href=#__codelineno-3-16><span class=linenos data-linenos="16 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><a href=#__codelineno-3-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a><a href=#__codelineno-3-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>;</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><a href=#__codelineno-3-19><span class=linenos data-linenos="19 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>It has an interesting type that is <code>code*</code> for those of you who do not know, <code>code*</code> is basically a function pointer. How code pointer is function pointer is not the part of discussion. This function first initializes an array of function pointers with addresses of functions in order. Then using a for loop, the functions are being called by giving the secret_ingredient as a parameter to the function. These functions use the secret_ingredient and then returns the secret ingredient as cake. Now, let's write a function that will take a <code>cake</code> as input and will give a <code>secret_ingredient</code> as output.</p> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><a href=#__codelineno-4-1><span class=linenos data-linenos="1 "></span></a><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=nf>cake_a_bake</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><a href=#__codelineno-4-2><span class=linenos data-linenos="2 "></span></a><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=n>recipe</span><span class=p>[</span><span class=mi>3</span><span class=p>])(</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=n>defrost_and_dake</span><span class=p>,</span><span class=w> </span><span class=n>seperate_and_dwadle</span><span class=p>,</span><span class=w> </span><span class=n>wait</span><span class=p>};</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a><a href=#__codelineno-4-3><span class=linenos data-linenos="3 "></span></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>&lt;</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><a href=#__codelineno-4-4><span class=linenos data-linenos="4 "></span></a><span class=w>        </span><span class=p>(</span><span class=o>*</span><span class=n>recipe</span><span class=p>[</span><span class=n>i</span><span class=p>])(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><a href=#__codelineno-4-5><span class=linenos data-linenos="5 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><a href=#__codelineno-4-6><span class=linenos data-linenos="6 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>cake</span><span class=p>;</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><a href=#__codelineno-4-7><span class=linenos data-linenos="7 "></span></a><span class=p>}</span>
</span></code></pre></div> <h4 id=prepare>prepare<a class=headerlink href=#prepare title="Permanent link">&para;</a></h4> <details class=prepare> <summary>Prepare</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><a href=#__codelineno-5-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=nf>prepare</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>){</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><a href=#__codelineno-5-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><a href=#__codelineno-5-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><a href=#__codelineno-5-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;prepin...&quot;</span><span class=p>);</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><a href=#__codelineno-5-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><a href=#__codelineno-5-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>        </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><a href=#__codelineno-5-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-84</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>((</span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-84</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>26</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>-26</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=sc>&#39;a&#39;</span><span class=p>;</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><a href=#__codelineno-5-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><a href=#__codelineno-5-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done&quot;</span><span class=p>);</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><a href=#__codelineno-5-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><a href=#__codelineno-5-11><span class=linenos data-linenos="11 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>we see a loop that modifies our secret_ingredient. At first, it looks like whatever is happening inside the loop does not look good. But if you look closely, if we take <code>secret_ingredient[i]-84</code> as <code>z</code>, the expression becomes: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><a href=#__codelineno-6-1><span class=linenos data-linenos="1 "></span></a><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>z</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>26</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>26</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=sc>&#39;a&#39;</span>
</span></code></pre></div> I don't know if any of you ever found reminder using the above method, but i did. We can rewrite the above expression as follows: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1></a><a href=#__codelineno-7-1><span class=linenos data-linenos="1 "></span></a><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>26</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=sc>&#39;a&#39;</span>
</span></code></pre></div> Now, seeing 26 as the constant, we can assume that the output of <code>secret_igredient[i]</code> is also going to be a character but something added to 'a'. Now, let's breakdown <code>z</code>.</p> <p><code>z = secret_ingredient[i] - 84</code></p> <p>I wanted to see what happens to the characters after this whole transformation of <code>prepare</code> function. Look what I found:</p> <p><a class=glightbox href=prep.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=rot13 src=prep.png></a></p> <p>The function does <code>rot13</code> on each characters. so, another simple rot13 would bring back the input from the output. Now, it's time to write <code>wait</code> function as designed by cake_a_bake function: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1></a><a href=#__codelineno-8-1><span class=linenos data-linenos="1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>wait</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2></a><a href=#__codelineno-8-2><span class=linenos data-linenos="2 "></span></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=n>secret_len</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3></a><a href=#__codelineno-8-3><span class=linenos data-linenos="3 "></span></a><span class=w>        </span><span class=n>cake</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;a&#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>(</span><span class=n>cake</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=mi>-84</span><span class=p>)</span><span class=o>%</span><span class=mi>26</span><span class=p>;</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4></a><a href=#__codelineno-8-4><span class=linenos data-linenos="4 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5></a><a href=#__codelineno-8-5><span class=linenos data-linenos="5 "></span></a><span class=p>}</span>
</span></code></pre></div></p> <h4 id=whisk_and_mix>whisk_and_mix<a class=headerlink href=#whisk_and_mix title="Permanent link">&para;</a></h4> <details class=whisk_and_mix> <summary>Whisk_and_mix</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1></a><a href=#__codelineno-9-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>whisk_and_mix</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>){</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2></a><a href=#__codelineno-9-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3></a><a href=#__codelineno-9-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4></a><a href=#__codelineno-9-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=p>;</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5></a><a href=#__codelineno-9-5><span class=linenos data-linenos=" 5 "></span></a>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6></a><a href=#__codelineno-9-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;whiskin...&quot;</span><span class=p>);</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7></a><a href=#__codelineno-9-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done&quot;</span><span class=p>);</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8></a><a href=#__codelineno-9-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9></a><a href=#__codelineno-9-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10></a><a href=#__codelineno-9-10><span class=linenos data-linenos="10 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11></a><a href=#__codelineno-9-11><span class=linenos data-linenos="11 "></span></a><span class=w>                </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12></a><a href=#__codelineno-9-12><span class=linenos data-linenos="12 "></span></a><span class=w>            </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13></a><a href=#__codelineno-9-13><span class=linenos data-linenos="13 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14></a><a href=#__codelineno-9-14><span class=linenos data-linenos="14 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15></a><a href=#__codelineno-9-15><span class=linenos data-linenos="15 "></span></a><span class=w>                </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16></a><a href=#__codelineno-9-16><span class=linenos data-linenos="16 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17></a><a href=#__codelineno-9-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18></a><a href=#__codelineno-9-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;mixin...&quot;</span><span class=p>);</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19></a><a href=#__codelineno-9-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done&quot;</span><span class=p>);</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20></a><a href=#__codelineno-9-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21></a><a href=#__codelineno-9-21><span class=linenos data-linenos="21 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>Our secret_len/2 is 11. so, the outer loop loops 11 times. the inner loop runs for every characters in the secret_ingredient. Let's see what happens in the inner loop after cleaning a bit: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1></a><a href=#__codelineno-10-1><span class=linenos data-linenos="1 "></span></a><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=o>+</span><span class=n>secret_len</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2></a><a href=#__codelineno-10-2><span class=linenos data-linenos="2 "></span></a><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3></a><a href=#__codelineno-10-3><span class=linenos data-linenos="3 "></span></a><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4></a><a href=#__codelineno-10-4><span class=linenos data-linenos="4 "></span></a><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></code></pre></div> for j=0; k=secret_len-1; and the inside working is inplace swapping of the jth character with it's previous character. So, after swapping all characters in the inner loop, the whole secret_ingredient is cyclic shifted left by one character. And it occurs 11 times. So, to revert our original secret ingredient, we need to cyclic right shift 11 times. The <code>separate_and_dwadle</code> function can be written as:</p> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1></a><a href=#__codelineno-11-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>separate_and_deadle</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2></a><a href=#__codelineno-11-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=n>secret_len</span><span class=o>/</span><span class=mi>2</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3></a><a href=#__codelineno-11-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=o>=</span><span class=n>secret_len</span><span class=mi>-1</span><span class=p>;</span><span class=n>j</span><span class=o>&gt;=</span><span class=mi>0</span><span class=p>;</span><span class=n>j</span><span class=o>--</span><span class=p>){</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4></a><a href=#__codelineno-11-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>            </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=o>+</span><span class=n>secret_len</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5></a><a href=#__codelineno-11-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>            </span><span class=n>cake</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>cake</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6></a><a href=#__codelineno-11-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>            </span><span class=n>cake</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>cake</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7></a><a href=#__codelineno-11-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>            </span><span class=n>cake</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>cake</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8></a><a href=#__codelineno-11-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9></a><a href=#__codelineno-11-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10></a><a href=#__codelineno-11-10><span class=linenos data-linenos="10 "></span></a><span class=p>}</span>
</span></code></pre></div> <h4 id=bake_and_frost>bake_and_frost<a class=headerlink href=#bake_and_frost title="Permanent link">&para;</a></h4> <details class=bake_and_frost> <summary>Bake_and_frost</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1></a><a href=#__codelineno-12-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>bake_and_frost</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>){</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2></a><a href=#__codelineno-12-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3></a><a href=#__codelineno-12-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4></a><a href=#__codelineno-12-4><span class=linenos data-linenos=" 4 "></span></a>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5></a><a href=#__codelineno-12-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;bakin...&quot;</span><span class=p>);</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6></a><a href=#__codelineno-12-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done...&quot;</span><span class=p>);</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7></a><a href=#__codelineno-12-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=p>(</span><span class=n>secret_len</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mi>31</span><span class=p>);</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8></a><a href=#__codelineno-12-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9></a><a href=#__codelineno-12-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>            </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10></a><a href=#__codelineno-12-10><span class=linenos data-linenos="10 "></span></a><span class=w>                </span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11></a><a href=#__codelineno-12-11><span class=linenos data-linenos="11 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12></a><a href=#__codelineno-12-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13></a><a href=#__codelineno-12-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;frostin...&quot;</span><span class=p>);</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14></a><a href=#__codelineno-12-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;done...&quot;</span><span class=p>);</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15></a><a href=#__codelineno-12-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16></a><a href=#__codelineno-12-16><span class=linenos data-linenos="16 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>The bake and frost function does the following to every characters of the secret_ingredient from first to last 2^23 times: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1></a><a href=#__codelineno-13-1><span class=linenos data-linenos="1 "></span></a><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span></code></pre></div> Each char in secret_ingredient is xored with it's previous char. To reverse this, we write the following function: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1></a><a href=#__codelineno-14-1><span class=linenos data-linenos="1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>defrost_and_dake</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2></a><a href=#__codelineno-14-2><span class=linenos data-linenos="2 "></span></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;</span><span class=p>(</span><span class=mi>2</span><span class=o>&lt;&lt;</span><span class=mi>23</span><span class=p>);</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3></a><a href=#__codelineno-14-3><span class=linenos data-linenos="3 "></span></a><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=o>=</span><span class=n>secret_len</span><span class=mi>-1</span><span class=p>;</span><span class=n>j</span><span class=o>&gt;=</span><span class=mi>0</span><span class=p>;</span><span class=n>j</span><span class=o>--</span><span class=p>){</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4></a><a href=#__codelineno-14-4><span class=linenos data-linenos="4 "></span></a><span class=w>            </span><span class=n>cake</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=n>cake</span><span class=p>[(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>secret_len</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>secret_len</span><span class=p>];</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5></a><a href=#__codelineno-14-5><span class=linenos data-linenos="5 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6></a><a href=#__codelineno-14-6><span class=linenos data-linenos="6 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7></a><a href=#__codelineno-14-7><span class=linenos data-linenos="7 "></span></a><span class=p>}</span>
</span></code></pre></div></p> <h4 id=serve_the_cake-and-taste_cake>serve_the_cake and taste_cake<a class=headerlink href=#serve_the_cake-and-taste_cake title="Permanent link">&para;</a></h4> <details class=serve_the_cake> <summary>Serve_the_cake</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1></a><a href=#__codelineno-15-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>serve_the_cake</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2></a><a href=#__codelineno-15-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>tasty</span><span class=p>;</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3></a><a href=#__codelineno-15-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>file</span><span class=p>;</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4></a><a href=#__codelineno-15-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5></a><a href=#__codelineno-15-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>flag</span><span class=w> </span><span class=p>[</span><span class=mi>72</span><span class=p>];</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6></a><a href=#__codelineno-15-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7></a><a href=#__codelineno-15-7><span class=linenos data-linenos=" 7 "></span></a>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8></a><a href=#__codelineno-15-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>);</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9></a><a href=#__codelineno-15-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=n>tasty</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>taste_cake</span><span class=p>(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10></a><a href=#__codelineno-15-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tasty</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11></a><a href=#__codelineno-15-11><span class=linenos data-linenos="11 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;You cannot just make a secret ingredient up. (-_-)&quot;</span><span class=p>);</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12></a><a href=#__codelineno-15-12><span class=linenos data-linenos="12 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13></a><a href=#__codelineno-15-13><span class=linenos data-linenos="13 "></span></a><span class=w>        </span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14></a><a href=#__codelineno-15-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15></a><a href=#__codelineno-15-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=n>file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=s>&quot;flag.txt&quot;</span><span class=p>,</span><span class=s>&quot;r&quot;</span><span class=p>);</span>
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16></a><a href=#__codelineno-15-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>file</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17></a><a href=#__codelineno-15-17><span class=linenos data-linenos="17 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;file not found</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18></a><a href=#__codelineno-15-18><span class=linenos data-linenos="18 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;If you are on a remote server contact the admin asap.&quot;</span><span class=p>);</span>
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19></a><a href=#__codelineno-15-19><span class=linenos data-linenos="19 "></span></a><span class=w>        </span><span class=n>puts</span><span class=p>(</span><span class=s>&quot;If you are on your local machine, create a flag.txt so that you can debug easily.&quot;</span><span class=p>);</span>
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20></a><a href=#__codelineno-15-20><span class=linenos data-linenos="20 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21></a><a href=#__codelineno-15-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22></a><a href=#__codelineno-15-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23></a><a href=#__codelineno-15-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=n>fgets</span><span class=p>(</span><span class=n>flag</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=n>file</span><span class=p>);</span>
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24></a><a href=#__codelineno-15-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=n>flag</span><span class=p>);</span>
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25></a><a href=#__codelineno-15-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26></a><a href=#__codelineno-15-26><span class=linenos data-linenos="26 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27></a><a href=#__codelineno-15-27><span class=linenos data-linenos="27 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28></a><a href=#__codelineno-15-28><span class=linenos data-linenos="28 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29></a><a href=#__codelineno-15-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30></a><a href=#__codelineno-15-30><span class=linenos data-linenos="30 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>this function is our target. upon successfully getting 1 from taste_cake, we will recieve the flag.txt from the server.</p> <details class=taste_cake> <summary>Taste_cake</summary> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1></a><a href=#__codelineno-16-1><span class=linenos data-linenos=" 1 "></span></a><span class=n>byte</span><span class=w> </span><span class=nf>taste_cake</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2></a><a href=#__codelineno-16-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3></a><a href=#__codelineno-16-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>some_cake</span><span class=w> </span><span class=p>[</span><span class=mi>23</span><span class=p>];</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4></a><a href=#__codelineno-16-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=n>byte</span><span class=w> </span><span class=n>f</span><span class=p>;</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5></a><a href=#__codelineno-16-5><span class=linenos data-linenos=" 5 "></span></a>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6></a><a href=#__codelineno-16-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>.</span><span class=n>_0_8_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x1070426e70144e3c</span><span class=p>;</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7></a><a href=#__codelineno-16-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>.</span><span class=n>_8_7_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x5413116e370e29</span><span class=p>;</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8></a><a href=#__codelineno-16-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x74</span><span class=p>;</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9></a><a href=#__codelineno-16-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>.</span><span class=n>_16_7_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x6a356833540227</span><span class=p>;</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10></a><a href=#__codelineno-16-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11></a><a href=#__codelineno-16-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>secret_len</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12></a><a href=#__codelineno-16-12><span class=linenos data-linenos="12 "></span></a><span class=w>        </span><span class=n>f</span><span class=w> </span><span class=o>&amp;=</span><span class=w> </span><span class=n>cake</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>some_cake</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13></a><a href=#__codelineno-16-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14></a><a href=#__codelineno-16-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=n>in_FS_OFFSET</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>40</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15></a><a href=#__codelineno-16-15><span class=linenos data-linenos="15 "></span></a><span class=w>                    </span><span class=cm>/* WARNING: Subroutine does not return */</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16></a><a href=#__codelineno-16-16><span class=linenos data-linenos="16 "></span></a><span class=w>        </span><span class=n>__stack_chk_fail</span><span class=p>();</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17></a><a href=#__codelineno-16-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18></a><a href=#__codelineno-16-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>f</span><span class=p>;</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19></a><a href=#__codelineno-16-19><span class=linenos data-linenos="19 "></span></a><span class=p>}</span>
</span></code></pre></div> </details> <p>Though it feels weird, the 23 consecutive bytes in some_cake needs to be extracted byte by byte for us to reconstruct the cake. We have to take note of endianness and reverse each 8 bytes to get the correct order.</p> <p>Now, the <code>get_cake</code> function will be as follows: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1></a><a href=#__codelineno-17-1><span class=linenos data-linenos=" 1 "></span></a><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=nf>get_cake</span><span class=p>(){</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2></a><a href=#__codelineno-17-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>some_cake</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=n>malloc</span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>char</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>23</span><span class=p>);</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3></a><a href=#__codelineno-17-3><span class=linenos data-linenos=" 3 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x3c</span><span class=p>;</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4></a><a href=#__codelineno-17-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x4e</span><span class=p>;</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5></a><a href=#__codelineno-17-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x14</span><span class=p>;</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6></a><a href=#__codelineno-17-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x70</span><span class=p>;</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7></a><a href=#__codelineno-17-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x6e</span><span class=p>;</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8></a><a href=#__codelineno-17-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x42</span><span class=p>;</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9></a><a href=#__codelineno-17-9><span class=linenos data-linenos=" 9 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x70</span><span class=p>;</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10></a><a href=#__codelineno-17-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x10</span><span class=p>;</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11></a><a href=#__codelineno-17-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x29</span><span class=p>;</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12></a><a href=#__codelineno-17-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x0e</span><span class=p>;</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13></a><a href=#__codelineno-17-13><span class=linenos data-linenos="13 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x37</span><span class=p>;</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14></a><a href=#__codelineno-17-14><span class=linenos data-linenos="14 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>11</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x6e</span><span class=p>;</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15></a><a href=#__codelineno-17-15><span class=linenos data-linenos="15 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x11</span><span class=p>;</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16></a><a href=#__codelineno-17-16><span class=linenos data-linenos="16 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>13</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x13</span><span class=p>;</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17></a><a href=#__codelineno-17-17><span class=linenos data-linenos="17 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>14</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x54</span><span class=p>;</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18></a><a href=#__codelineno-17-18><span class=linenos data-linenos="18 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>15</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x74</span><span class=p>;</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19></a><a href=#__codelineno-17-19><span class=linenos data-linenos="19 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>16</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x27</span><span class=p>;</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20></a><a href=#__codelineno-17-20><span class=linenos data-linenos="20 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>17</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x02</span><span class=p>;</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21></a><a href=#__codelineno-17-21><span class=linenos data-linenos="21 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>18</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x54</span><span class=p>;</span>
</span><span id=__span-17-22><a id=__codelineno-17-22 name=__codelineno-17-22></a><a href=#__codelineno-17-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>19</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x33</span><span class=p>;</span>
</span><span id=__span-17-23><a id=__codelineno-17-23 name=__codelineno-17-23></a><a href=#__codelineno-17-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>20</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x68</span><span class=p>;</span>
</span><span id=__span-17-24><a id=__codelineno-17-24 name=__codelineno-17-24></a><a href=#__codelineno-17-24><span class=linenos data-linenos="24 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>21</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x35</span><span class=p>;</span>
</span><span id=__span-17-25><a id=__codelineno-17-25 name=__codelineno-17-25></a><a href=#__codelineno-17-25><span class=linenos data-linenos="25 "></span></a><span class=w>    </span><span class=n>some_cake</span><span class=p>[</span><span class=mi>22</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mh>0x6a</span><span class=p>;</span>
</span><span id=__span-17-26><a id=__codelineno-17-26 name=__codelineno-17-26></a><a href=#__codelineno-17-26><span class=linenos data-linenos="26 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>some_cake</span><span class=p>;</span>
</span><span id=__span-17-27><a id=__codelineno-17-27 name=__codelineno-17-27></a><a href=#__codelineno-17-27><span class=linenos data-linenos="27 "></span></a><span class=p>}</span>
</span></code></pre></div> We now pass the cake to cake_a_bake and then get a secret_ingredient. we then preserve the secret_ingredient.</p> <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1></a><a href=#__codelineno-18-1><span class=linenos data-linenos="1 "></span></a><span class=kt>void</span><span class=w> </span><span class=nf>preserve</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>secret_ingredient</span><span class=p>){</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2></a><a href=#__codelineno-18-2><span class=linenos data-linenos="2 "></span></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>&lt;</span><span class=n>secret_len</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3></a><a href=#__codelineno-18-3><span class=linenos data-linenos="3 "></span></a><span class=w>        </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;%c&quot;</span><span class=p>,</span><span class=n>secret_ingredient</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4></a><a href=#__codelineno-18-4><span class=linenos data-linenos="4 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5></a><a href=#__codelineno-18-5><span class=linenos data-linenos="5 "></span></a><span class=p>}</span>
</span></code></pre></div> <p>Now, we have all the required to retrieve the secret_ingredient from the cake. the following c file computes the secret_ingredient from the cake.</p> <p><a href=secret.c>secret</a></p> <p>Now, we hit a wall of disappointment.</p> <p><a class=glightbox href=disappointment.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=disappointment src=disappointment.png></a></p> <p>We can assume that we messed up somewhere bigtime. But upon further observation of the reversal code, everything seems to be okay. But there is a catch. all the letters in the input are rotated whether they are between <code>a</code> and <code>z</code> or not. My guess is that there were some characters in the secret_ingredient that were not in the range <code>a~z</code> so, rot13 becomes reversible for only those who were between <code>a~z</code> and irreversible for those who were not. Now, we change the secret code a little in our recipe, we do the following: <div class="language-c highlight"><span class=filename>C</span><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1></a><a href=#__codelineno-19-1><span class=linenos data-linenos="1 "></span></a><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=nf>cake_a_bake</span><span class=p>(</span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>cake</span><span class=p>){</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2></a><a href=#__codelineno-19-2><span class=linenos data-linenos="2 "></span></a><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=n>recipe</span><span class=p>[</span><span class=mi>3</span><span class=p>])(</span><span class=kt>char</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=n>defrost_and_dake</span><span class=p>,</span><span class=w> </span><span class=n>seperate_and_dwadle</span><span class=p>,</span><span class=w> </span><span class=n>wait</span><span class=p>};</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3></a><a href=#__codelineno-19-3><span class=linenos data-linenos="3 "></span></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>&lt;</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>){</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4></a><a href=#__codelineno-19-4><span class=linenos data-linenos="4 "></span></a><span class=w>        </span><span class=p>(</span><span class=o>*</span><span class=n>recipe</span><span class=p>[</span><span class=n>i</span><span class=p>])(</span><span class=n>cake</span><span class=p>);</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5></a><a href=#__codelineno-19-5><span class=linenos data-linenos="5 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6></a><a href=#__codelineno-19-6><span class=linenos data-linenos="6 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>cake</span><span class=p>;</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7></a><a href=#__codelineno-19-7><span class=linenos data-linenos="7 "></span></a><span class=p>}</span>
</span></code></pre></div> This way, we will now get the secret ingredient before it was rotated. The string we get is: <code>\hcZel\ZpeZ^lXateZqXZa^</code> we head over to cyberchef and only do rot13 on characters.</p> <p>The string we get is: <code>\upMry\McrM^yKngrMdKMn^</code></p> <p>The previous secret we go was: <code>iupgryigcrgkyengrgdegnk</code></p> <p>If we compare the two, we can see that some characters appear at exactly the same position as the other one. Now, we keep them as they are highly likely the original characters, not the 1337 converted to characters. <code>_up_ry__cr__y_ngr_d__n_</code>.</p> <p>Not too clear what it exactly means. Now, we need to make a cake of only most probable 1337 codes to guess what 1337 code was used for the recipe. We make the following change in the code of 1 <code>cake_a_bake</code>:</p> <p>When we put <code>134570!@_</code> in wait, we get the following output: <code>XZ[\^WHMl</code>; Now, we can replace occurances of any of <code>XZ[\^WHMl</code> with it's corresponding 1337 code in <code>\hcZel\ZpeZ^lXateZqXZa^</code>. After adding it with <code>_up_ry__cr__y_ngr_d__n_</code> we get: <code>5up3ry53cr37y1ngr3d13n7</code>. aslo, see that both <code>l</code> and <code>_</code> are converted to <code>y</code> upon rot13. so, we can safely assume that the secret was: <code>5up3r_53cr37_1ngr3d13n7</code>.</p> <p>Annd voila we got our flag:</p> <p><a class=glightbox href=voila.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt=voila src=voila.png></a></p> <p>flag: <code>coderush{7h3_c@k3_w@5_5up3r_d3l15h}</code></p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">August 9, 2023 21:56:35</span> <br> Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">June 19, 2023 06:08:59</span> </small> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../../bcactf/rev/git_better/index.html class="md-footer__link md-footer__link--prev" aria-label="Previous: Git Better" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Git Better </div> </div> </a> <a href=../keasy/index.html class="md-footer__link md-footer__link--next" aria-label="Next: Keasy" rel=next> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Keasy </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 - 2023 Md Abdullahil Kafi </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/gr007-40 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.facebook.com/gr00t.40 target=_blank rel=noopener title=www.facebook.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> <a href=https://www.linkedin.com/in/gr007 target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://twitter.com/groot_40 target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.prune", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "search.suggest", "search.share", "search.highlight", "header.autohide", "content.code.copy", "content.code.annotate", "content.tabs.link", "content.action.view"], "search": "../../../../../assets/javascripts/workers/search.74e28a9f.min.js", "tags": {"pwn": "pwn"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../../assets/javascripts/bundle.220ee61c.min.js></script> <script src=../../../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../../../../javascripts/katex.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>